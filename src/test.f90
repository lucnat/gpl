
! These tests assume that GPLInfinity = 30

PROGRAM TEST
  use globals
  use utils
  use shuffle
  use maths_functions
  use mpl_module
  use gpl_module
  implicit none
  
  complex(kind=prec) :: res 
  real :: tol = 8.0e-7
  logical :: tests_successful = .true. 
#ifdef HAVE_GINAC
  character(len=6) :: ginacwhat
#endif

#ifdef DEBUG
  call parse_cmd_args()
#endif

  tol = 8e-10
  call do_MPL_tests() 
  call do_GPL_tests()
  ! call do_shuffle_tests() ! put this somewhere else
  tol = 8.0e-7
  call do_chen_test(cmplx(0.3),cmplx(0.1))

#ifdef HAVE_GINAC
  tol = 2.0e-5
  ginacwhat = 'values'
  call do_muone_tests(cmplx(0.4),cmplx(.7),"")
  ginacwhat = 'speed1'
  call do_muone_tests(cmplx(0.4),cmplx(.7),"using GiNaC")
  ginacwhat = 'speed2'
  call do_muone_tests(cmplx(0.4),cmplx(.7),"using GPL")
#endif

  if(tests_successful) then
    print*, 'All tests passed. '
  else 
    print*, 'Some tests failed. '
    stop 1
  end if

CONTAINS
   
  subroutine check(res, ref)
    complex(kind=prec) :: res, ref
    real(kind=prec) :: delta

    delta = abs(res-ref)
    if(delta < tol) then
      print*, '       ',' passed with delta = ', delta
    else 
      print*, '  ',' FAILED with delta = ', delta
      tests_successful = .false.
    end if
  end subroutine check

  subroutine test_one_MPL(m,x,ref, test_id)
    integer :: m(:)
    complex(kind=prec) :: x(:), ref
    character(len=*) :: test_id
    
    print*, '  ', 'testing MPL ', test_id, ' ...'
    res = MPL(m,x)
    call check(res,ref)
  end subroutine test_one_MPL

  subroutine do_MPL_tests()
    complex(kind=prec) :: ref
    print*, 'doing MPL tests...'
    
    ref = cmplx(0.022696600480693277651633)
    call test_one_MPL((/ 1,1 /),cmplx((/ 0.3156498673740053, 0.3431255827785649 /)),ref, '1.1')
    
    ref = cmplx(0.00023134615630308335448329926098409)
    call test_one_MPL((/ 1,1 /),cmplx((/ 0.03, 0.5012562893380046 /)),ref, '1.2')
    
    ref = cmplx(0.000023446106415452030937059124671151)
    call test_one_MPL((/ 2,1,2 /),cmplx((/ 0.03, 0.5012562893380046, 55.3832 /)),ref, '1.3')  
  end subroutine do_MPL_tests

  subroutine test_one_condensed(m,z,y,k,ref,test_id)
    integer :: m(:), k
    complex(kind=prec) :: z(:), y, res, ref
    character(len=*) :: test_id

    print*, '  ', 'testing GPL ', test_id, ' ...'
    res = G_condensed(m,toinum(z),inum(y,di0),k)
    call check(res,ref)
  end subroutine test_one_condensed

  subroutine test_one_flat(z,ref,test_id)
    complex(kind=prec) :: z(:), res, ref
    character(len=*) :: test_id

    print*, '  ', 'testing GPL ', test_id, ' ...'
    res = G(z)
    call check(res,ref)
  end subroutine test_one_flat

  subroutine do_GPL_tests()
    complex(kind=prec) :: ref
    real(kind=prec) :: z, xchen
    print*, 'doing GPL tests...'
    
    ref = cmplx(0.0819393734128676)
    call test_one_condensed((/ 1,1 /),cmplx((/ 1.3, 1.1 /)),cmplx(0.4),2,ref,'2.1')
    
    ref = cmplx(0.01592795952537145)
    call test_one_condensed((/ 3,2 /),cmplx((/ 1.3, 1.1 /)),cmplx(0.4),2,ref,'2.2')
    
    ref = cmplx(0.0020332632172573974)
    call test_one_condensed((/ 4 /),cmplx((/ 0 /)),cmplx(1.6),1,ref,'2.3')

    ! requires making convergent
    ref = (0.09593041677639341, -0.8829351795197851)
    call test_one_flat(cmplx([0,1,3,2]),ref,'2.4')

    ref = (0.009947947789928621,0.0)
    call test_one_flat(cmplx([0.0, 0.0, -3.3333333333333335, -3.3333333333333335, 1.0]),ref,'2.5')

    ! requires hoelder convolution
    ref = (-0.012709942828250949,0.0)
    call test_one_flat(cmplx([0.0, 3.3333333333333335, 1.0, 3.3333333333333335, 1.0]),ref,'2.6')

    ! here the tests from the mathematica nb start
    ! --------------------------------------------------------------------------

    z = 1./200; xchen = 0.3;

    ref = (-0.0050125418235441935,0.0)
    call test_one_flat(cmplx([1./z,1.0]),ref,'3.1')

    ref = (-0.0015011261262671913,0.0)
    call test_one_flat(cmplx([1./(xchen*z),1.0]),ref,'3.2')

    ref = (-0.0007502860817810596,0.0)
    call test_one_flat(cmplx([(1+sqrt(1-z**2))/(xchen*z),1.0]),ref,'3.3')

    ref = (0.0074335969894765335,0.0)
    call test_one_flat(cmplx([-1./xchen,-1./xchen,1.,1.,1.0]),ref,'3.4')
    
    ref = (-8.403785974849544e-6,0.0)
    call test_one_flat(cmplx([-1./xchen,0.,-1./xchen,1./(xchen*z),1.0]),ref,'3.5')
    
    ref = cmplx((0.4925755847450199,2.6389214054743295))
    call test_one_flat(cmplx([-1.,-1.,z,z,1.]),ref,'3.6')
    
    ref = cmplx((-0.0015317713178859967,-0.00045003911367000565))
    call test_one_flat(cmplx([0.,0.,(1-sqrt(1-z**2))/(xchen*z), 1./(xchen*z),1.]),ref,'3.7')


    ! here the chen integral tests start
    ! ----------------------------------------------------------------------

    ref = (-1.2039728043259361,0.0)
    call test_one_flat(cmplx([0., 0.3]),ref,'4.1')

    ref = (10.603796220956799,0.0)
    call test_one_flat(cmplx([0., 0., 0.01]),ref,'4.2')

    ref = (0.0005042990065180765,0.0)
    call test_one_flat(cmplx([100., 1., 0.3]),ref,'4.3')

    ref = (0.05630861877185141,0.0)
    call test_one_flat(cmplx([1., 0., 0.01]),ref,'4.4')

    ref = (0.04032895150872735,0.2922709647568842)
    call test_one_flat([(0.01,0.9999499987499375), (0.3,0)],ref,'4.5')

    ref = cmplx(0.000025210645098340354)
    call test_one_flat(cmplx([100., 199.99499987499374, 1.]),ref,'4.6')

    ref = (0.0556470547632135,0.)
    call test_one_flat(cmplx([-1., 0.01, 0., 0.01]),ref,'4.7')

    ref = (0.00003794895846844715,0.)
    call test_one_flat(cmplx([100., 100., 1., 0., 1.]),ref,'4.8')

    ref = (0.00007574284433216497,0.)
    call test_one_flat(cmplx([100., 1., 100., 0., 1.]),ref,'4.9')

    ref = (1.8801911586012443,2.509434138598062)
    call test_one_flat(cmplx([0.01, -1.0, 0.01, 1.]),ref,'4.10')

    ref = (-0.012539108315054982, -0.015414250168437678)
    call test_one_flat(cmplx([0.01, 199.99499987499374, 0.01, 1.]),ref,'4.11')



  end subroutine do_GPL_tests
  


  subroutine do_chen_test(xchen,z)
    complex(kind=prec) :: ref,xchen,z
      ref = (-1.2039728043259361,0)
    call test_one_flat(cmplx([(0.,0.),xchen]),ref,'5.1')
    ref = (-2.302585092994046,0)
    call test_one_flat(cmplx([(0.,0.),z]),ref,'5.2')
    ref = (-0.10536051565782635,0)
    call test_one_flat(cmplx([1/z,(1.,0.)]),ref,'5.3')
    ref = (-0.03045920748470844,0)
    call test_one_flat(cmplx([1/z,xchen]),ref,'5.4')
    ref = (2.1972245773362196,3.141592653589793)
    call test_one_flat(cmplx([z,(1.,0.)]),ref,'5.5')
    ref = (0.6931471805599453,3.141592653589793)
    call test_one_flat(cmplx([z,xchen]),ref,'5.6')
    ref = (0.09531017980432493,0)
    call test_one_flat(cmplx([-(1/z),(1.,0.)]),ref,'5.7')
    ref = (2.6509490552391997,0)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),z]),ref,'5.8')
    ref = (1.3862943611198906,0)
    call test_one_flat(cmplx([-z,xchen]),ref,'5.9')
    ref = (2.3978952727983707,0)
    call test_one_flat(cmplx([-z,(1.,0.)]),ref,'5.10')
    ref = (0.02955880224154443,0)
    call test_one_flat(cmplx([-(1/z),xchen]),ref,'5.11')
    ref = (0.09760523522932159,0)
    call test_one_flat(cmplx([(0.,0.),-(1/z),(1.,0.)]),ref,'5.12')
    ref = (0.02977795032718629,0)
    call test_one_flat(cmplx([(0.,0.),-(1/z),xchen]),ref,'5.13')
    ref = (4.198277886858104,0)
    call test_one_flat(cmplx([(0.,0.),-z,(1.,0.)]),ref,'5.14')
    ref = (1.939375420766709,0)
    call test_one_flat(cmplx([(0.,0.),-z,xchen]),ref,'5.15')
    ref = (0.10261779109939115,0)
    call test_one_flat(cmplx([1/z,(0.,0.),(1.,0.)]),ref,'5.16')
    ref = (0.005137258776755887,0)
    call test_one_flat(cmplx([1/z,(1.,0.),xchen]),ref,'5.17')
    ref = (0.5363012873578618,-7.233784412415465)
    call test_one_flat(cmplx([z,(0.,0.),(1.,0.)]),ref,'5.18')
    ref = (0.014779401120772175,-0.2985316036528414)
    call test_one_flat(cmplx([z - Sqrt((-1.,0.) + z**2),xchen]),ref,'5.19')
    ref = (-0.31706503445734235,0)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),z]),ref,'5.20')
    ref = (0.34521934384326786,0)
    call test_one_flat(cmplx([(1.,0.),(0.,0.),z]),ref,'5.21')
    ref = (0.014779401120772175,0.2985316036528414)
    call test_one_flat(cmplx([z + Sqrt((-1.,0.) + z**2),xchen]),ref,'5.22')
    ref = (1.606425842967944,3.141592653589793)
    call test_one_flat(cmplx([((1.,0.) - Sqrt((1.,0.) - z**2))/z,xchen]),ref,'5.23')
    ref = (-0.015151901161512445,0)
    call test_one_flat(cmplx([((1.,0.) + Sqrt((1.,0.) - z**2))/z,xchen]),ref,'5.24')
    ref = (2.941797302011275,3.141592653589793)
    call test_one_flat(cmplx([((1.,0.) - Sqrt((1.,0.) - z**2))/z,(1.,0.)]),ref,'5.25')
    ref = (-0.05142554411510811,0)
    call test_one_flat(cmplx([((1.,0.) + Sqrt((1.,0.) - z**2))/z,(1.,0.)]),ref,'5.26')
    ref = (0.29389333245105953,-0.8354818739782282)
    call test_one_flat(cmplx([z - Sqrt((-1.,0.) + z**2),(1.,0.)]),ref,'5.27')
    ref = (0.29389333245105953,0.8354818739782282)
    call test_one_flat(cmplx([z + Sqrt((-1.,0.) + z**2),(1.,0.)]),ref,'5.28')
    ref = (0.10816821022923255,0)
    call test_one_flat(cmplx([1/z,(1.,0.),(1.,0.)]),ref,'5.29')
    ref = (0.016234241787653182,-0.06411636118465684)
    call test_one_flat(cmplx([1/z,z,xchen]),ref,'5.30')
    ref = (0.3332875175037837,0.2994257606855894)
    call test_one_flat(cmplx([z,(-1.,0.),xchen]),ref,'5.31')
    ref = (-0.04132965831306227,0)
    call test_one_flat(cmplx([1/z,(-1.,0.),(1.,0.)]),ref,'5.32')
    ref = (-0.10261779109939115,0)
    call test_one_flat(cmplx([(0.,0.),1/z,(1.,0.)]),ref,'5.33')
    ref = (-1.6449340668482264,0)
    call test_one_flat(cmplx([(0.,0.),z,z]),ref,'5.34')
    ref = (0.03316686525599525,0)
    call test_one_flat(cmplx([1/z,(0.,0.),z]),ref,'5.35')
    ref = (0.005726777345270627,0)
    call test_one_flat(cmplx([(1.,0.),1/z,xchen]),ref,'5.36')
    ref = (-0.003800950050070699,0)
    call test_one_flat(cmplx([(-1.,0.),1/z,xchen]),ref,'5.37')
    ref = (0.5274154023686162,1.8781603296180127)
    call test_one_flat(cmplx([(-1.,0.),z,(1.,0.)]),ref,'5.38')
    ref = (-0.010553639915431167,-0.0799033918263922)
    call test_one_flat(cmplx([1/z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,xchen]),ref,'5.39')
    ref = (0.00023134615630304115,0)
    call test_one_flat(cmplx([1/z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,xchen]),ref,'5.40')
    ref = (-1.5145225618428348,5.621094786755514)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) - Sqrt((1.,0.) - z**2))/z,xchen]),ref,'5.41')
    ref = (-0.015094602761175174,0)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) + Sqrt((1.,0.) - z**2))/z,xchen]),ref,'5.42')
    ref = (-0.5363012873578618,7.233784412415465)
    call test_one_flat(cmplx([(0.,0.),z,(1.,0.)]),ref,'5.43')
    ref = (-0.3261295100754761,0)
    call test_one_flat(cmplx([(0.,0.),(1.,0.),xchen]),ref,'5.44')
    ref = (0.28007433375958285,0)
    call test_one_flat(cmplx([(0.,0.),(-1.,0.),xchen]),ref,'5.45')
    ref = (0.005550419129841536,0)
    call test_one_flat(cmplx([1/z,1/z,(1.,0.)]),ref,'5.46')
    ref = (-2.320180423313098,3.451392295223203)
    call test_one_flat(cmplx([(0.,0.),z,xchen]),ref,'5.47')
    ref = (0.0004638816602982593,0)
    call test_one_flat(cmplx([1/z,1/z,xchen]),ref,'5.48')
    ref = (-0.1922881631435671,-0.31521279132732455)
    call test_one_flat(cmplx([1/z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,(1.,0.)]),ref,'5.49')
    ref = (0.002733460180579584,0)
    call test_one_flat(cmplx([1/z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,(1.,0.)]),ref,'5.50')
    ref = (1.2405915447167828,9.403486903947776)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) - Sqrt((1.,0.) - z**2))/z,(1.,0.)]),ref,'5.51')
    ref = (-0.05076817512677344,0)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) + Sqrt((1.,0.) - z**2))/z,(1.,0.)]),ref,'5.52')
    ref = (0.16993564728812333,-0.7895275616284134)
    call test_one_flat(cmplx([(1.,0.),z,xchen]),ref,'5.53')
    ref = (-0.03170068605750171,0)
    call test_one_flat(cmplx([(-1.,0.),1/z,(1.,0.)]),ref,'5.54')
    ref = (-0.15143046730845847,0.52481588512997)
    call test_one_flat(cmplx([(-1.,0.),z,xchen]),ref,'5.55')
    ref = (-0.030228051617706822,0)
    call test_one_flat(cmplx([(0.,0.),1/z,xchen]),ref,'5.56')
    ref = (0.9955846184690019,0.29942576068558946)
    call test_one_flat(cmplx([z,(-1.,0.),(1.,0.)]),ref,'5.57')
    ref = (-0.0041904575179174475,0)
    call test_one_flat(cmplx([1/z,(-1.,0.),xchen]),ref,'5.58')
    ref = (-0.10627903312871827,-0.2994257606855892)
    call test_one_flat(cmplx([1/z,z,(1.,0.)]),ref,'5.59')
    ref = (-0.10536051565782635,0)
    call test_one_flat(cmplx([(1.,0.),z]),ref,'5.60')
    ref = (0.09531017980432493,0)
    call test_one_flat(cmplx([(-1.,0.),z]),ref,'5.61')
    ref = (-0.010050335853501506,0)
    call test_one_flat(cmplx([1/z,z]),ref,'5.62')
    ref = (-1.9846029915616528,-0.33099982196905964)
    call test_one_flat(cmplx([z,(1.,0.),(1.,0.)]),ref,'5.63')
    ref = (-0.1252216813554754,-0.031574061283470435)
    call test_one_flat(cmplx([z,1/z,(1.,0.)]),ref,'5.64')
    ref = (-0.03734695557776922,-0.03157406128347043)
    call test_one_flat(cmplx([z,1/z,xchen]),ref,'5.65')
    ref = (-2.520904278919514,6.902784590446406)
    call test_one_flat(cmplx([z,z,(1.,0.)]),ref,'5.66')
    ref = (-4.694575693585578,2.1775860903036026)
    call test_one_flat(cmplx([z,z,xchen]),ref,'5.67')
    ref = (0.7555564425621878,0)
    call test_one_flat(cmplx([(1.,0.),(0.,0.),xchen]),ref,'5.68')
    ref = (0.06690010907061678,0)
    call test_one_flat(cmplx([1/z,(0.,0.),xchen]),ref,'5.69')
    ref = (1.4856500685237246,-7.233784412415465)
    call test_one_flat(cmplx([z,(0.,0.),xchen]),ref,'5.70')
    ref = (-1.6385845158315626,9.072487081978718)
    call test_one_flat(cmplx([z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,(1.,0.)]),ref,'5.71')
    ref = (-5.0317015483101475,4.347288581835913)
    call test_one_flat(cmplx([z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,xchen]),ref,'5.72')
    ref = (-0.06193780939846582,-0.015787030641735082)
    call test_one_flat(cmplx([z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,(1.,0.)]),ref,'5.73')
    ref = (-0.01861578991066939,-0.015787030641735075)
    call test_one_flat(cmplx([z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,xchen]),ref,'5.74')
    ref = (-0.09615617680065747,0)
    call test_one_flat(cmplx([(-1.,0.),(-1.,0.),(0.,0.),xchen]),ref,'5.75')
    ref = (-0.017417131848226637,0)
    call test_one_flat(cmplx([(-1.,0.),(-1.,0.),(0.,0.),z]),ref,'5.76')
    ref = (0.8169970423269313,0)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.77')
    ref = (0.5761923409248666,0)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),(0.,0.),z]),ref,'5.78')
    ref = (-0.06033742863030898,0)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),z,z]),ref,'5.79')
    ref = (0.11161548337989241,0)
    call test_one_flat(cmplx([(-1.,0.),(1.,0.),(0.,0.),xchen]),ref,'5.80')
    ref = (0.0183942275801002,0)
    call test_one_flat(cmplx([(-1.,0.),(1.,0.),(0.,0.),z]),ref,'5.81')
    ref = (0.04931359475906201,0)
    call test_one_flat(cmplx([(-1.,0.),1/z,(0.,0.),(1.,0.)]),ref,'5.82')
    ref = (0.0103639911560276,0)
    call test_one_flat(cmplx([(-1.,0.),1/z,(0.,0.),xchen]),ref,'5.83')
    ref = (0.0017932246366415786,0)
    call test_one_flat(cmplx([(-1.,0.),1/z,(0.,0.),z]),ref,'5.84')
    ref = (1.181211405301244,-4.32462397723122)
    call test_one_flat(cmplx([(-1.,0.),z,(0.,0.),(1.,0.)]),ref,'5.85')
    ref = (0.8461208776617349,-1.2084332336667447)
    call test_one_flat(cmplx([(-1.,0.),z,(0.,0.),xchen]),ref,'5.86')
    ref = (0.3084567951031315,0)
    call test_one_flat(cmplx([(-1.,0.),z,(0.,0.),z]),ref,'5.87')
    ref = (-0.9164819493199052,0)
    call test_one_flat(cmplx([(0.,0.),(-1.,0.),(0.,0.),xchen]),ref,'5.88')
    ref = (-0.4223154599986133,0)
    call test_one_flat(cmplx([(0.,0.),(-1.,0.),(0.,0.),z]),ref,'5.89')
    ref = (-0.2908698994697784,0)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.90')
    ref = (-2.034678592293477,0)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),(0.,0.),z]),ref,'5.91')
    ref = (-1.2020569031595942,0)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),z,z]),ref,'5.92')
    ref = (1.0174514166047999,0)
    call test_one_flat(cmplx([(0.,0.),(1.,0.),(0.,0.),xchen]),ref,'5.93')
    ref = (0.4388635650198811,0)
    call test_one_flat(cmplx([(0.,0.),(1.,0.),(0.,0.),z]),ref,'5.94')
    ref = (0.09662077778365975,0)
    call test_one_flat(cmplx([(0.,0.),1/z,(0.,0.),xchen]),ref,'5.95')
    ref = (0.04310874723662727,0)
    call test_one_flat(cmplx([(0.,0.),1/z,(0.,0.),z]),ref,'5.96')
    ref = (10.277679319279873,-7.947124449055453)
    call test_one_flat(cmplx([(0.,0.),z,(0.,0.),xchen]),ref,'5.97')
    ref = (6.191714467601987,0)
    call test_one_flat(cmplx([(0.,0.),z,(0.,0.),z]),ref,'5.98')
    ref = (1.2020569031595942,0)
    call test_one_flat(cmplx([(0.,0.),z,z,z]),ref,'5.99')
    ref = (0.14063389809070653,0)
    call test_one_flat(cmplx([(1.,0.),(-1.,0.),(0.,0.),xchen]),ref,'5.100')
    ref = (0.019781967644159407,0)
    call test_one_flat(cmplx([(1.,0.),(-1.,0.),(0.,0.),z]),ref,'5.101')
    ref = (-0.9635604127914625,0)
    call test_one_flat(cmplx([(1.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.102')
    ref = (-0.6168802399832878,0)
    call test_one_flat(cmplx([(1.,0.),(0.,0.),(0.,0.),z]),ref,'5.103')
    ref = (0.06934338982599011,0)
    call test_one_flat(cmplx([(1.,0.),(0.,0.),z,z]),ref,'5.104')
    ref = (-0.1647137971740692,0)
    call test_one_flat(cmplx([(1.,0.),(1.,0.),(0.,0.),xchen]),ref,'5.105')
    ref = (-0.020913148533099744,0)
    call test_one_flat(cmplx([(1.,0.),(1.,0.),(0.,0.),z]),ref,'5.106')
    ref = (-0.01522317880800524,0)
    call test_one_flat(cmplx([(1.,0.),1/z,(0.,0.),xchen]),ref,'5.107')
    ref = (-0.002037802115827065,0)
    call test_one_flat(cmplx([(1.,0.),1/z,(0.,0.),z]),ref,'5.108')
    ref = (-1.1170803609658266,1.8179543939135228)
    call test_one_flat(cmplx([(1.,0.),z,(0.,0.),xchen]),ref,'5.109')
    ref = (-0.3558090018727161,0)
    call test_one_flat(cmplx([(1.,0.),z,(0.,0.),z]),ref,'5.110')
    ref = (0.09878555018070007,0)
    call test_one_flat(cmplx([-(1/z),(0.,0.),(0.,0.),(1.,0.)]),ref,'5.111')
    ref = (0.08716381838201068,0)
    call test_one_flat(cmplx([-(1/z),(0.,0.),(0.,0.),xchen]),ref,'5.112')
    ref = (0.011570456902349749,0)
    call test_one_flat(cmplx([1/z,(-1.,0.),(0.,0.),xchen]),ref,'5.113')
    ref = (0.0018631455003514583,0)
    call test_one_flat(cmplx([1/z,(-1.,0.),(0.,0.),z]),ref,'5.114')
    ref = (-0.08858334485556062,0)
    call test_one_flat(cmplx([1/z,(0.,0.),(0.,0.),xchen]),ref,'5.115')
    ref = (-0.059739138378212035,0)
    call test_one_flat(cmplx([1/z,(0.,0.),(0.,0.),z]),ref,'5.116')
    ref = (0.06934338982599011,0)
    call test_one_flat(cmplx([1/z,(0.,0.),(1.,0.),(1.,0.)]),ref,'5.117')
    ref = (0.006494434813701424,0)
    call test_one_flat(cmplx([1/z,(0.,0.),z,z]),ref,'5.118')
    ref = (-0.01348745474104714,0)
    call test_one_flat(cmplx([1/z,(1.,0.),(0.,0.),xchen]),ref,'5.119')
    ref = (-0.001968724121820856,0)
    call test_one_flat(cmplx([1/z,(1.,0.),(0.,0.),z]),ref,'5.120')
    ref = (-0.0012496285146482448,0)
    call test_one_flat(cmplx([1/z,1/z,(0.,0.),xchen]),ref,'5.121')
    ref = (-0.00019187911659637247,0)
    call test_one_flat(cmplx([1/z,1/z,(0.,0.),z]),ref,'5.122')
    ref = (-0.0971631337810641,0.1476333774808129)
    call test_one_flat(cmplx([1/z,z,(0.,0.),xchen]),ref,'5.123')
    ref = (-0.03326292133823407,0)
    call test_one_flat(cmplx([1/z,z,(0.,0.),z]),ref,'5.124')
    ref = (5.921064803756975,0)
    call test_one_flat(cmplx([-z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.125')
    ref = (5.688497670116243,0)
    call test_one_flat(cmplx([-z,(0.,0.),(0.,0.),xchen]),ref,'5.126')
    ref = (-0.8068771100768982,-0.996089182961381)
    call test_one_flat(cmplx([z,(-1.,0.),(0.,0.),xchen]),ref,'5.127')
    ref = (-6.0331807992637,8.328202076980272)
    call test_one_flat(cmplx([z,(0.,0.),(0.,0.),xchen]),ref,'5.128')
    ref = (-1.4649303394721798,-0.3223832986454593)
    call test_one_flat(cmplx([z,(0.,0.),(1.,0.),(1.,0.)]),ref,'5.129')
    ref = (0.97916967005139,1.0845385544950985)
    call test_one_flat(cmplx([z,(1.,0.),(0.,0.),xchen]),ref,'5.130')
    ref = (0.08904964468104185,0.10419678023083721)
    call test_one_flat(cmplx([z,1/z,(0.,0.),xchen]),ref,'5.131')
    ref = (-0.3566749439387324,0)
    call test_one_flat(cmplx([(1.,0.),xchen]),ref,'5.132')
    ref = (0.20257736895844594,0)
    call test_one_flat(cmplx([(0.,0.),1/z,(0.,0.),(1.,0.)]),ref,'5.133')
    ref = (11.283622829502683,-16.656404153960544)
    call test_one_flat(cmplx([(0.,0.),z,(0.,0.),(1.,0.)]),ref,'5.134')
    ref = (-0.10128868447922297,0)
    call test_one_flat(cmplx([1/z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.135')
    ref = (-0.00813283618485774,0)
    call test_one_flat(cmplx([1/z,1/z,(0.,0.),(1.,0.)]),ref,'5.136')
    ref = (-0.15291570481811476,0.6894532930130404)
    call test_one_flat(cmplx([1/z,z,(0.,0.),(1.,0.)]),ref,'5.137')
    ref = (-5.641811414751341,8.328202076980272)
    call test_one_flat(cmplx([z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.138')
    ref = (0.21998375576999404,0.10419678023083723)
    call test_one_flat(cmplx([z,1/z,(0.,0.),(1.,0.)]),ref,'5.139')
    ref = (16.11280770208083,-10.726536118060935)
    call test_one_flat(cmplx([z,z,(0.,0.),(1.,0.)]),ref,'5.140')
    ref = (0.26236426446749106,0)
    call test_one_flat(cmplx([(-1.,0.),xchen]),ref,'5.141')
    ref = (14.820181687751358,0.15363550980570562)
    call test_one_flat(cmplx([z,z,(0.,0.),xchen]),ref,'5.142')
    ref = (-5.42818127524307,14.073365917073366)
    call test_one_flat(cmplx([((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.143')
    ref = (-5.761615321095605,14.073365917073367)
    call test_one_flat(cmplx([((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),xchen]),ref,'5.144')
    ref = (0.2239603187679372,0.06302130938492317)
    call test_one_flat(cmplx([((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),(1.,0.)]),ref,'5.145')
    ref = (0.1069971189174173,0.06302130938492316)
    call test_one_flat(cmplx([((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),xchen]),ref,'5.146')
    ref = (14.763127795027831,-12.940384318387462)
    call test_one_flat(cmplx([((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,(0.,0.),(1.,0.)]),ref,'5.147')
    ref = (13.633530270830104,-3.2805950731753146)
    call test_one_flat(cmplx([((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,(0.,0.),xchen]),ref,'5.148')
    ref = (-0.050444467131442856,0)
    call test_one_flat(cmplx([((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.149')
    ref = (-0.04422129621160459,0)
    call test_one_flat(cmplx([((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),xchen]),ref,'5.150')
    ref = (-0.003949906101903422,0)
    call test_one_flat(cmplx([((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),(1.,0.)]),ref,'5.151')
    ref = (-0.0006204314978198616,0)
    call test_one_flat(cmplx([((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),xchen]),ref,'5.152')
    ref = (-0.07545617046365549,0.33565031800155354)
    call test_one_flat(cmplx([((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,(0.,0.),(1.,0.)]),ref,'5.153')
    ref = (-0.04836802386860166,0.07325460502230909)
    call test_one_flat(cmplx([((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,(0.,0.),xchen]),ref,'5.154')
    ref = (0.019290141425222167,-0.9855183430525558)
    call test_one_flat(cmplx([z - Sqrt((-1.,0.) + z**2),(0.,0.),(0.,0.),(1.,0.)]),ref,'5.155')
    ref = (-0.017187387087385562,-0.8773130732094856)
    call test_one_flat(cmplx([z - Sqrt(-1 + z**2),(0.,0.),(0.,0.),xchen]),ref,'5.156')
    ref = (0.027303786810059127,-0.060535354166867006)
    call test_one_flat(cmplx([z - Sqrt((-1.,0.) + z**2),1/z,(0.,0.),(1.,0.)]),ref,'5.157')
    ref = (0.0010642816085948503,-0.01216055795925336)
    call test_one_flat(cmplx([z - Sqrt((-1.,0.) + z**2),1/z,(0.,0.),xchen]),ref,'5.158')
    ref = (-5.090450907454442,-3.540960743706521)
    call test_one_flat(cmplx([z - Sqrt((-1.,0.) + z**2),z,(0.,0.),(1.,0.)]),ref,'5.159')
    ref = (-1.4002761158519084,-1.1007736514523734)
    call test_one_flat(cmplx([z - Sqrt((-1.,0.) + z**2),z,(0.,0.),xchen]),ref,'5.160')
    ref = (0.019290141425222167,0.9855183430525558)
    call test_one_flat(cmplx([z + Sqrt((-1.,0.) + z**2),(0.,0.),(0.,0.),(1.,0.)]),ref,'5.161')
    ref = (-0.017187387087385562,0.8773130732094856)
    call test_one_flat(cmplx([z + Sqrt((-1.,0.) + z**2),(0.,0.),(0.,0.),xchen]),ref,'5.162')
    ref = (0.027303786810059103,0.060535354166867006)
    call test_one_flat(cmplx([z + Sqrt((-1.,0.) + z**2),1/z,(0.,0.),(1.,0.)]),ref,'5.163')
    ref = (0.0010642816085948503,0.01216055795925336)
    call test_one_flat(cmplx([z + Sqrt((-1.,0.) + z**2),1/z,(0.,0.),xchen]),ref,'5.164')
    ref = (5.547761546563603,-0.7836632335246997)
    call test_one_flat(cmplx([z + Sqrt((-1.,0.) + z**2),z,(0.,0.),(1.,0.)]),ref,'5.165')
    ref = (1.4695713467220322,0.8142496857112194)
    call test_one_flat(cmplx([z + Sqrt((-1.,0.) + z**2),z,(0.,0.),xchen]),ref,'5.166')
    ref = (0.15686771352941373,0)
    call test_one_flat(cmplx([(-1.,0.),(-1.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.167')
    ref = (-0.13615497727912967,0)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),(-1.,0.),(0.,0.),xchen]),ref,'5.168')
    ref = (-0.922703634335271,0)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.169')
    ref = (0.14565285373078768,0)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),(1.,0.),(0.,0.),xchen]),ref,'5.170')
    ref = (0.07980308827314511,0)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),1/z,(0.,0.),(1.,0.)]),ref,'5.171')
    ref = (0.014098358367768005,0)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),1/z,(0.,0.),xchen]),ref,'5.172')
    ref = (6.507239473434343,-6.301845600647784)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),z,(0.,0.),(1.,0.)]),ref,'5.173')
    ref = (1.7971105678252794,-0.765099340012343)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),z,(0.,0.),xchen]),ref,'5.174')
    ref = (-0.17404491276535905,0)
    call test_one_flat(cmplx([(-1.,0.),(1.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.175')
    ref = (-0.058853079185470725,0)
    call test_one_flat(cmplx([(-1.,0.),1/z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.176')
    ref = (-0.01653550312789659,0)
    call test_one_flat(cmplx([(-1.,0.),1/z,(0.,0.),(0.,0.),xchen]),ref,'5.177')
    ref = (-0.0019185540771125957,0)
    call test_one_flat(cmplx([(-1.,0.),1/z,1/z,(0.,0.),(1.,0.)]),ref,'5.178')
    ref = (-0.0001146310371002467,0)
    call test_one_flat(cmplx([(-1.,0.),1/z,1/z,(0.,0.),xchen]),ref,'5.179')
    ref = (-0.06811835001758731,0.1824482153969609)
    call test_one_flat(cmplx([(-1.,0.),1/z,z,(0.,0.),(1.,0.)]),ref,'5.180')
    ref = (-0.013188203788298637,0.011946303512295545)
    call test_one_flat(cmplx([(-1.,0.),1/z,z,(0.,0.),xchen]),ref,'5.181')
    ref = (-4.276243287860533,4.978907351388616)
    call test_one_flat(cmplx([(-1.,0.),z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.182')
    ref = (-1.8150288452769923,1.391260174859819)
    call test_one_flat(cmplx([(-1.,0.),z,(0.,0.),(0.,0.),xchen]),ref,'5.183')
    ref = (0.07354381381810508,0.06229269058159658)
    call test_one_flat(cmplx([(-1.,0.),z,1/z,(0.,0.),(1.,0.)]),ref,'5.184')
    ref = (0.004137983361489419,0.01740649774631191)
    call test_one_flat(cmplx([(-1.,0.),z,1/z,(0.,0.),xchen]),ref,'5.185')
    ref = (8.378234365665664,-1.3989586778404939)
    call test_one_flat(cmplx([(-1.,0.),z,z,(0.,0.),(1.,0.)]),ref,'5.186')
    ref = (1.6177184220022625,1.2855036117439795)
    call test_one_flat(cmplx([(-1.,0.),z,z,(0.,0.),xchen]),ref,'5.187')
    ref = (-0.06181102794374975,0)
    call test_one_flat(cmplx([(0.,0.),(-1.,0.),(-1.,0.),(0.,0.),xchen]),ref,'5.188')
    ref = (1.7844686828294622,0)
    call test_one_flat(cmplx([(0.,0.),(-1.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.189')
    ref = (0.06805496526884641,0)
    call test_one_flat(cmplx([(0.,0.),(-1.,0.),(1.,0.),(0.,0.),xchen]),ref,'5.190')
    ref = (0.03790307009779634,0)
    call test_one_flat(cmplx([(0.,0.),(-1.,0.),1/z,(0.,0.),(1.,0.)]),ref,'5.191')
    ref = (0.006494684391893419,0)
    call test_one_flat(cmplx([(0.,0.),(-1.,0.),1/z,(0.,0.),xchen]),ref,'5.192')
    ref = (2.045247102286723,-3.655969102129449)
    call test_one_flat(cmplx([(0.,0.),(-1.,0.),z,(0.,0.),(1.,0.)]),ref,'5.193')
    ref = (0.8142405968515838,-0.5625002605288849)
    call test_one_flat(cmplx([(0.,0.),(-1.,0.),z,(0.,0.),xchen]),ref,'5.194')
    ref = (-1.232759011511069,0)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),(-1.,0.),(0.,0.),xchen]),ref,'5.195')
    ref = (0.08754986213965806,0)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.196')
    ref = (1.1712551489122673,0)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),(0.,0.),(0.,0.),z]),ref,'5.197')
    ref = (1.2941049241728957,0)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),(1.,0.),(0.,0.),xchen]),ref,'5.198')
    ref = (0.3019132593596135,0)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),1/z,(0.,0.),(1.,0.)]),ref,'5.199')
    ref = (0.12642561012958675,0)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),1/z,(0.,0.),xchen]),ref,'5.200')
    ref = (28.84207915882289,-19.176393953896827)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),z,(0.,0.),(1.,0.)]),ref,'5.201')
    ref = (15.750943507129762,-4.365404289653551)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),z,(0.,0.),xchen]),ref,'5.202')
    ref = (0.07852035219600186,0)
    call test_one_flat(cmplx([(0.,0.),(1.,0.),(-1.,0.),(0.,0.),xchen]),ref,'5.203')
    ref = (-1.9065968418304342,0)
    call test_one_flat(cmplx([(0.,0.),(1.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.204')
    ref = (-0.08712183665377612,0)
    call test_one_flat(cmplx([(0.,0.),(1.,0.),(1.,0.),(0.,0.),xchen]),ref,'5.205')
    ref = (-0.10672365718038085,0)
    call test_one_flat(cmplx([(0.,0.),(1.,0.),1/z,(0.,0.),(1.,0.)]),ref,'5.206')
    ref = (-0.00828176170400757,0)
    call test_one_flat(cmplx([(0.,0.),(1.,0.),1/z,(0.,0.),xchen]),ref,'5.207')
    ref = (-3.0352804935056446,9.401856103860158)
    call test_one_flat(cmplx([(0.,0.),(1.,0.),z,(0.,0.),(1.,0.)]),ref,'5.208')
    ref = (-0.9912316953521113,0.7795224587719884)
    call test_one_flat(cmplx([(0.,0.),(1.,0.),z,(0.,0.),xchen]),ref,'5.209')
    ref = (0.2981609109652751,0)
    call test_one_flat(cmplx([(0.,0.),-(1/z),(0.,0.),(0.,0.),(1.,0.)]),ref,'5.210')
    ref = (0.1833844145262658,0)
    call test_one_flat(cmplx([(0.,0.),-(1/z),(0.,0.),(0.,0.),xchen]),ref,'5.211')
    ref = (0.04649668012425319,0)
    call test_one_flat(cmplx([(0.,0.),1/z,(-1.,0.),(0.,0.),(1.,0.)]),ref,'5.212')
    ref = (0.0069662090830283855,0)
    call test_one_flat(cmplx([(0.,0.),1/z,(-1.,0.),(0.,0.),xchen]),ref,'5.213')
    ref = (-0.3019132593596135,0)
    call test_one_flat(cmplx([(0.,0.),1/z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.214')
    ref = (-0.18459000452175972,0)
    call test_one_flat(cmplx([(0.,0.),1/z,(0.,0.),(0.,0.),xchen]),ref,'5.215')
    ref = (0.030420536003533307,0)
    call test_one_flat(cmplx([(0.,0.),1/z,(0.,0.),(1.,0.),(1.,0.)]),ref,'5.216')
    ref = (-0.062075843263720024,0)
    call test_one_flat(cmplx([(0.,0.),1/z,(1.,0.),(0.,0.),(1.,0.)]),ref,'5.217')
    ref = (-0.0076982247243823606,0)
    call test_one_flat(cmplx([(0.,0.),1/z,(1.,0.),(0.,0.),xchen]),ref,'5.218')
    ref = (-0.00526520552505905,0)
    call test_one_flat(cmplx([(0.,0.),1/z,1/z,(0.,0.),(1.,0.)]),ref,'5.219')
    ref = (-0.0007332935496827155,0)
    call test_one_flat(cmplx([(0.,0.),1/z,1/z,(0.,0.),xchen]),ref,'5.220')
    ref = (-0.23943592352381673,0.5023930247937802)
    call test_one_flat(cmplx([(0.,0.),1/z,z,(0.,0.),(1.,0.)]),ref,'5.221')
    ref = (-0.09005423703279505,0.06627244178873591)
    call test_one_flat(cmplx([(0.,0.),1/z,z,(0.,0.),xchen]),ref,'5.222')
    ref = (21.979710744081245,0)
    call test_one_flat(cmplx([(0.,0.),-z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.223')
    ref = (14.923275325858592,0)
    call test_one_flat(cmplx([(0.,0.),-z,(0.,0.),(0.,0.),xchen]),ref,'5.224')
    ref = (-1.6041569734519698,-2.293580103979495)
    call test_one_flat(cmplx([(0.,0.),z,(-1.,0.),(0.,0.),(1.,0.)]),ref,'5.225')
    ref = (0.02388973793945917,-1.0943158170107496)
    call test_one_flat(cmplx([(0.,0.),z,(-1.,0.),(0.,0.),xchen]),ref,'5.226')
    ref = (-28.84207915882289,19.176393953896827)
    call test_one_flat(cmplx([(0.,0.),z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.227')
    ref = (-21.937966703127795,9.149465144281802)
    call test_one_flat(cmplx([(0.,0.),z,(0.,0.),(0.,0.),xchen]),ref,'5.228')
    ref = (-1.0577097162422484,-0.7423149776912822)
    call test_one_flat(cmplx([(0.,0.),z,(0.,0.),(1.,0.),(1.,0.)]),ref,'5.229')
    ref = (2.153100235836137,2.497242308357726)
    call test_one_flat(cmplx([(0.,0.),z,(1.,0.),(0.,0.),(1.,0.)]),ref,'5.230')
    ref = (0.03477993597283746,1.191487383502664)
    call test_one_flat(cmplx([(0.,0.),z,(1.,0.),(0.,0.),xchen]),ref,'5.231')
    ref = (0.18440187005139333,0.23992195289750248)
    call test_one_flat(cmplx([(0.,0.),z,1/z,(0.,0.),(1.,0.)]),ref,'5.232')
    ref = (0.0004325056324103564,0.11447186320124808)
    call test_one_flat(cmplx([(0.,0.),z,1/z,(0.,0.),xchen]),ref,'5.233')
    ref = (26.02000892724163,3.8794878928476635)
    call test_one_flat(cmplx([(0.,0.),z,z,(0.,0.),(1.,0.)]),ref,'5.234')
    ref = (7.2171446923783265,10.561899332406064)
    call test_one_flat(cmplx([(0.,0.),z,z,(0.,0.),xchen]),ref,'5.235')
    ref = (-40.52205166086182,42.124720384880376)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.236')
    ref = (-33.88864289312931,25.180770555396506)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),xchen]),ref,'5.237')
    ref = (0.2542188213778448,0.1886368230437511)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),(1.,0.)]),ref,'5.238')
    ref = (0.05866014955575212,0.11276088045129266)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),xchen]),ref,'5.239')
    ref = (29.052158445938087,-1.8343600754495224)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,(0.,0.),(1.,0.)]),ref,'5.240')
    ref = (11.81773857800373,8.054476661520404)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,(0.,0.),xchen]),ref,'5.241')
    ref = (-0.1508527354552175,0)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.242')
    ref = (-0.0923740927924169,0)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),xchen]),ref,'5.243')
    ref = (-0.002588256287656716,0)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),(1.,0.)]),ref,'5.244')
    ref = (-0.00036534802408684123,0)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),xchen]),ref,'5.245')
    ref = (-0.11900252960964065,0.24723946647903217)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,(0.,0.),(1.,0.)]),ref,'5.246')
    ref = (-0.04491896583925218,0.03295012780378208)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,(0.,0.),xchen]),ref,'5.247')
    ref = (-0.22438647000656317,0)
    call test_one_flat(cmplx([(1.,0.),(-1.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.248')
    ref = (0.20093319914956861,0)
    call test_one_flat(cmplx([(1.,0.),(0.,0.),(-1.,0.),(0.,0.),xchen]),ref,'5.249')
    ref = (1.0222324580521427,0)
    call test_one_flat(cmplx([(1.,0.),(0.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.250')
    ref = (-0.21577152810861688,0)
    call test_one_flat(cmplx([(1.,0.),(0.,0.),(1.,0.),(0.,0.),xchen]),ref,'5.251')
    ref = (-0.020845484576028406,0)
    call test_one_flat(cmplx([(1.,0.),(0.,0.),1/z,(0.,0.),xchen]),ref,'5.252')
    ref = (-2.633295224745442,1.2177045786195937)
    call test_one_flat(cmplx([(1.,0.),(0.,0.),z,(0.,0.),xchen]),ref,'5.253')
    ref = (0.2506021485286153,0)
    call test_one_flat(cmplx([(1.,0.),(1.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.254')
    ref = (0.023727769780132604,0)
    call test_one_flat(cmplx([(1.,0.),1/z,(0.,0.),(0.,0.),xchen]),ref,'5.255')
    ref = (0.0001795492718332183,0)
    call test_one_flat(cmplx([(1.,0.),1/z,1/z,(0.,0.),xchen]),ref,'5.256')
    ref = (0.0200301357751825,-0.019264433603862853)
    call test_one_flat(cmplx([(1.,0.),1/z,z,(0.,0.),xchen]),ref,'5.257')
    ref = (2.484730647473504,-2.092997343584152)
    call test_one_flat(cmplx([(1.,0.),z,(0.,0.),(0.,0.),xchen]),ref,'5.258')
    ref = (-0.008005551881758317,-0.026186154252426)
    call test_one_flat(cmplx([(1.,0.),z,1/z,(0.,0.),xchen]),ref,'5.259')
    ref = (-2.6352193045812595,-1.7455331062296493)
    call test_one_flat(cmplx([(1.,0.),z,z,(0.,0.),xchen]),ref,'5.260')
    ref = (-0.08500492328976514,0)
    call test_one_flat(cmplx([1/z,(-1.,0.),(0.,0.),(0.,0.),(1.,0.)]),ref,'5.261')
    ref = (-0.01867509758378673,0)
    call test_one_flat(cmplx([1/z,(-1.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.262')
    ref = (-0.002386758110495735,0)
    call test_one_flat(cmplx([1/z,(-1.,0.),1/z,(0.,0.),(1.,0.)]),ref,'5.263')
    ref = (-0.00012393328901465006,0)
    call test_one_flat(cmplx([1/z,(-1.,0.),1/z,(0.,0.),xchen]),ref,'5.264')
    ref = (-0.09358085529861374,0.22973247345903855)
    call test_one_flat(cmplx([1/z,(-1.,0.),z,(0.,0.),(1.,0.)]),ref,'5.265')
    ref = (-0.01445772573669578,0.012716455228492643)
    call test_one_flat(cmplx([1/z,(-1.,0.),z,(0.,0.),xchen]),ref,'5.266')
    ref = (0.1235131664552771,0)
    call test_one_flat(cmplx([1/z,(0.,0.),(-1.,0.),(0.,0.),(1.,0.)]),ref,'5.267')
    ref = (0.016453470640490655,0)
    call test_one_flat(cmplx([1/z,(0.,0.),(-1.,0.),(0.,0.),xchen]),ref,'5.268')
    ref = (0.10063775311987117,0)
    call test_one_flat(cmplx([1/z,(0.,0.),(0.,0.),(0.,0.),(1.,0.)]),ref,'5.269')
    ref = (0.09708064754802684,0)
    call test_one_flat(cmplx([1/z,(0.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.270')
    ref = (0.05979618598821792,0)
    call test_one_flat(cmplx([1/z,(0.,0.),(0.,0.),(1.,0.),(1.,0.)]),ref,'5.271')
    ref = (-0.15001290797996913,0)
    call test_one_flat(cmplx([1/z,(0.,0.),(1.,0.),(0.,0.),(1.,0.)]),ref,'5.272')
    ref = (-0.01763287288484966,0)
    call test_one_flat(cmplx([1/z,(0.,0.),(1.,0.),(0.,0.),xchen]),ref,'5.273')
    ref = (-0.013461254237996868,0)
    call test_one_flat(cmplx([1/z,(0.,0.),1/z,(0.,0.),(1.,0.)]),ref,'5.274')
    ref = (-0.0017052255387996701,0)
    call test_one_flat(cmplx([1/z,(0.,0.),1/z,(0.,0.),xchen]),ref,'5.275')
    ref = (-1.038299010112328,1.0851318500137028)
    call test_one_flat(cmplx([1/z,(0.,0.),z,(0.,0.),(1.,0.)]),ref,'5.276')
    ref = (-0.2165561283675252,0.095919400929263)
    call test_one_flat(cmplx([1/z,(0.,0.),z,(0.,0.),xchen]),ref,'5.277')
    ref = (0.10604437562184459,0)
    call test_one_flat(cmplx([1/z,(1.,0.),(0.,0.),(0.,0.),(1.,0.)]),ref,'5.278')
    ref = (0.020784813158514846,0)
    call test_one_flat(cmplx([1/z,(1.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.279')
    ref = (0.008309460201014113,0)
    call test_one_flat(cmplx([1/z,(1.,0.),1/z,(0.,0.),(1.,0.)]),ref,'5.280')
    ref = (0.00016409929142151346,0)
    call test_one_flat(cmplx([1/z,(1.,0.),1/z,(0.,0.),xchen]),ref,'5.281')
    ref = (0.15866252353641008,-0.7060552291720098)
    call test_one_flat(cmplx([1/z,(1.,0.),z,(0.,0.),(1.,0.)]),ref,'5.282')
    ref = (0.018007936416226337,-0.017837964252905)
    call test_one_flat(cmplx([1/z,(1.,0.),z,(0.,0.),xchen]),ref,'5.283')
    ref = (-0.003037763429410108,0)
    call test_one_flat(cmplx([1/z,1/z,(-1.,0.),(0.,0.),(1.,0.)]),ref,'5.284')
    ref = (-0.00013440172637899138,0)
    call test_one_flat(cmplx([1/z,1/z,(-1.,0.),(0.,0.),xchen]),ref,'5.285')
    ref = (0.009363229881527959,0)
    call test_one_flat(cmplx([1/z,1/z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.286')
    ref = (0.0019715189178145433,0)
    call test_one_flat(cmplx([1/z,1/z,(0.,0.),(0.,0.),xchen]),ref,'5.287')
    ref = (-0.0022574812215878756,0)
    call test_one_flat(cmplx([1/z,1/z,(0.,0.),(1.,0.),(1.,0.)]),ref,'5.288')
    ref = (0.004243915442969869,0)
    call test_one_flat(cmplx([1/z,1/z,(1.,0.),(0.,0.),(1.,0.)]),ref,'5.289')
    ref = (0.00015072503352769315,0)
    call test_one_flat(cmplx([1/z,1/z,(1.,0.),(0.,0.),xchen]),ref,'5.290')
    ref = (0.00034975408565129516,0)
    call test_one_flat(cmplx([1/z,1/z,1/z,(0.,0.),(1.,0.)]),ref,'5.291')
    ref = (0.000014251540339082276,0)
    call test_one_flat(cmplx([1/z,1/z,1/z,(0.,0.),xchen]),ref,'5.292')
    ref = (0.0113348643938065,-0.03285595866187836)
    call test_one_flat(cmplx([1/z,1/z,z,(0.,0.),(1.,0.)]),ref,'5.293')
    ref = (0.0016170616892861788,-0.001506515324743712)
    call test_one_flat(cmplx([1/z,1/z,z,(0.,0.),xchen]),ref,'5.294')
    ref = (0.11480952102311914,0.09493743912919261)
    call test_one_flat(cmplx([1/z,z,(-1.,0.),(0.,0.),(1.,0.)]),ref,'5.295')
    ref = (0.004947732470420204,0.020329056268292935)
    call test_one_flat(cmplx([1/z,z,(-1.,0.),(0.,0.),xchen]),ref,'5.296')
    ref = (0.6388674668180724,-0.7937624374037415)
    call test_one_flat(cmplx([1/z,z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.297')
    ref = (0.21179606802790205,-0.16996920710784136)
    call test_one_flat(cmplx([1/z,z,(0.,0.),(0.,0.),xchen]),ref,'5.298')
    ref = (0.07242903400931201,0.03072641015981083)
    call test_one_flat(cmplx([1/z,z,(0.,0.),(1.,0.),(1.,0.)]),ref,'5.299')
    ref = (-0.15160333253253672,-0.10336756463365243)
    call test_one_flat(cmplx([1/z,z,(1.,0.),(0.,0.),(1.,0.)]),ref,'5.300')
    ref = (-0.0065584025920926384,-0.02213420813778716)
    call test_one_flat(cmplx([1/z,z,(1.,0.),(0.,0.),xchen]),ref,'5.301')
    ref = (-0.013044201498505562,-0.009931013858834607)
    call test_one_flat(cmplx([1/z,z,1/z,(0.,0.),(1.,0.)]),ref,'5.302')
    ref = (-0.000573385760892996,-0.0021265387121180276)
    call test_one_flat(cmplx([1/z,z,1/z,(0.,0.),xchen]),ref,'5.303')
    ref = (-1.3844035752018886,0.34914881557983674)
    call test_one_flat(cmplx([1/z,z,z,(0.,0.),(1.,0.)]),ref,'5.304')
    ref = (-0.20548251687538,-0.15001735533549865)
    call test_one_flat(cmplx([1/z,z,z,(0.,0.),xchen]),ref,'5.305')
    ref = (0.6455298224453472,-1.4120560630362244)
    call test_one_flat(cmplx([1/z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.306')
    ref = (0.23498428383318237,-0.35794254544845805)
    call test_one_flat(cmplx([1/z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),xchen]),ref,'5.307')
    ref = (-0.014568707752061214,-0.006323264991604758)
    call test_one_flat(cmplx([1/z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),(1.,0.)]),ref,'5.308')
    ref = (-0.0014804796921057551,-0.0016028864758912186)
    call test_one_flat(cmplx([1/z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),xchen]),ref,'5.309')
    ref = (-1.3303337157918882,0.6268820351223359)
    call test_one_flat(cmplx([1/z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,(0.,0.),(1.,0.)]),ref,'5.310')
    ref = (-0.2500186990760142,-0.06307367422454743)
    call test_one_flat(cmplx([1/z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,(0.,0.),xchen]),ref,'5.311')
    ref = (0.004669014059138387,0)
    call test_one_flat(cmplx([1/z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.312')
    ref = (0.000985600492488227,0)
    call test_one_flat(cmplx([1/z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),xchen]),ref,'5.313')
    ref = (0.0001713462468405014,0)
    call test_one_flat(cmplx([1/z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),(1.,0.)]),ref,'5.314')
    ref = (7.093882959291758e-6,0)
    call test_one_flat(cmplx([1/z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),xchen]),ref,'5.315')
    ref = (0.005621308586251496,-0.016125820294398928)
    call test_one_flat(cmplx([1/z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,(0.,0.),(1.,0.)]),ref,'5.316')
    ref = (0.0008061295630469726,-0.0007488029291084704)
    call test_one_flat(cmplx([1/z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,(0.,0.),xchen]),ref,'5.317')
    ref = (2.3918748530756475,1.8101616253042665)
    call test_one_flat(cmplx([z,(-1.,0.),(0.,0.),(0.,0.),(1.,0.)]),ref,'5.318')
    ref = (1.0750881710182352,1.8101616253042656)
    call test_one_flat(cmplx([z,(-1.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.319')
    ref = (0.04904540762492971,0.005633581344709428)
    call test_one_flat(cmplx([z,(-1.,0.),1/z,(0.,0.),(1.,0.)]),ref,'5.320')
    ref = (0.011169017363332062,0.005633581344709408)
    call test_one_flat(cmplx([z,(-1.,0.),1/z,(0.,0.),xchen]),ref,'5.321')
    ref = (3.187771242883774,-4.044715902032041)
    call test_one_flat(cmplx([z,(-1.,0.),z,(0.,0.),(1.,0.)]),ref,'5.322')
    ref = (1.6620386477069478,-0.2907925708357765)
    call test_one_flat(cmplx([z,(-1.,0.),z,(0.,0.),xchen]),ref,'5.323')
    ref = (-3.1795927326993256,-1.3267431466290378)
    call test_one_flat(cmplx([z,(0.,0.),(-1.,0.),(0.,0.),(1.,0.)]),ref,'5.324')
    ref = (-1.2026079830102394,-1.3267431466290374)
    call test_one_flat(cmplx([z,(0.,0.),(-1.,0.),(0.,0.),xchen]),ref,'5.325')
    ref = (9.614026386274297,-6.3921313179656085)
    call test_one_flat(cmplx([z,(0.,0.),(0.,0.),(0.,0.),(1.,0.)]),ref,'5.326')
    ref = (9.733917436340901,-6.3921313179656085)
    call test_one_flat(cmplx([z,(0.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.327')
    ref = (-1.3207048742850342,-0.3182077870517014)
    call test_one_flat(cmplx([z,(0.,0.),(0.,0.),(1.,0.),(1.,0.)]),ref,'5.328')
    ref = (3.699119464812317,1.378730551794685)
    call test_one_flat(cmplx([z,(0.,0.),(1.,0.),(0.,0.),(1.,0.)]),ref,'5.329')
    ref = (1.3085000778313005,1.3787305517946846)
    call test_one_flat(cmplx([z,(0.,0.),(1.,0.),(0.,0.),xchen]),ref,'5.330')
    ref = (0.34104492028266403,0.13543012362404755)
    call test_one_flat(cmplx([z,(0.,0.),1/z,(0.,0.),(1.,0.)]),ref,'5.331')
    ref = (0.12565458922030837,0.1354301236240475)
    call test_one_flat(cmplx([z,(0.,0.),1/z,(0.,0.),xchen]),ref,'5.332')
    ref = (36.27755733661688,-9.126405373212958)
    call test_one_flat(cmplx([z,(0.,0.),z,(0.,0.),(1.,0.)]),ref,'5.333')
    ref = (19.959697363355282,9.058731211186311)
    call test_one_flat(cmplx([z,(0.,0.),z,(0.,0.),xchen]),ref,'5.334')
    ref = (-2.926109850324227,-1.9379864300762055)
    call test_one_flat(cmplx([z,(1.,0.),(0.,0.),(0.,0.),(1.,0.)]),ref,'5.335')
    ref = (-1.2610868336834058,-1.9379864300762049)
    call test_one_flat(cmplx([z,(1.,0.),(0.,0.),(0.,0.),xchen]),ref,'5.336')
    ref = (-0.12999579244933318,-0.006401944156552053)
    call test_one_flat(cmplx([z,(1.,0.),1/z,(0.,0.),(1.,0.)]),ref,'5.337')
    ref = (-0.014589609872484388,-0.006401944156552042)
    call test_one_flat(cmplx([z,(1.,0.),1/z,(0.,0.),xchen]),ref,'5.338')
    ref = (-4.5674310303768,10.781291465853442)
    call test_one_flat(cmplx([z,(1.,0.),z,(0.,0.),(1.,0.)]),ref,'5.339')
    ref = (-2.068203208533971,0.589115339554737)
    call test_one_flat(cmplx([z,(1.,0.),z,(0.,0.),xchen]),ref,'5.340')
    ref = (0.059539801140959706,0.0058532442164730344)
    call test_one_flat(cmplx([z,1/z,(-1.,0.),(0.,0.),(1.,0.)]),ref,'5.341')
    ref = (0.012075242836279466,0.005853244216473019)
    call test_one_flat(cmplx([z,1/z,(-1.,0.),(0.,0.),xchen]),ref,'5.342')
    ref = (-0.2627233951670287,-0.187676038260775)
    call test_one_flat(cmplx([z,1/z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.343')
    ref = (-0.11665022264179042,-0.18767603826077495)
    call test_one_flat(cmplx([z,1/z,(0.,0.),(0.,0.),xchen]),ref,'5.344')
    ref = (0.037474879174238,0.0016086468996051794)
    call test_one_flat(cmplx([z,1/z,(0.,0.),(1.,0.),(1.,0.)]),ref,'5.345')
    ref = (-0.07840890750939708,-0.0061849292380574215)
    call test_one_flat(cmplx([z,1/z,(1.,0.),(0.,0.),(1.,0.)]),ref,'5.346')
    ref = (-0.013478973752553525,-0.006184929238057417)
    call test_one_flat(cmplx([z,1/z,(1.,0.),(0.,0.),xchen]),ref,'5.347')
    ref = (-0.006709310392893261,-0.0006028060230764632)
    call test_one_flat(cmplx([z,1/z,1/z,(0.,0.),(1.,0.)]),ref,'5.348')
    ref = (-0.0012779734627744513,-0.0006028060230764629)
    call test_one_flat(cmplx([z,1/z,1/z,(0.,0.),xchen]),ref,'5.349')
    ref = (-0.37069268392729215,0.5687007211970018)
    call test_one_flat(cmplx([z,1/z,z,(0.,0.),(1.,0.)]),ref,'5.350')
    ref = (-0.18604752584377698,0.04238327862474489)
    call test_one_flat(cmplx([z,1/z,z,(0.,0.),xchen]),ref,'5.351')
    ref = (-1.278240029250722,-2.968121612945874)
    call test_one_flat(cmplx([z,z,(-1.,0.),(0.,0.),(1.,0.)]),ref,'5.352')
    ref = (0.7155302252554987,-1.4699263876803128)
    call test_one_flat(cmplx([z,z,(-1.,0.),(0.,0.),xchen]),ref,'5.353')
    ref = (-31.148783131929257,2.623458740182647)
    call test_one_flat(cmplx([z,z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.354')
    ref = (-22.50996888147775,-9.902801759588598)
    call test_one_flat(cmplx([z,z,(0.,0.),(0.,0.),xchen]),ref,'5.355')
    ref = (-1.0991262944008224,-1.0349727063317822)
    call test_one_flat(cmplx([z,z,(0.,0.),(1.,0.),(1.,0.)]),ref,'5.356')
    ref = (1.9119259019970083,3.282933029317427)
    call test_one_flat(cmplx([z,z,(1.,0.),(0.,0.),(1.,0.)]),ref,'5.357')
    ref = (-0.6738591350743627,1.651703103568935)
    call test_one_flat(cmplx([z,z,(1.,0.),(0.,0.),xchen]),ref,'5.358')
    ref = (0.15524487037282084,0.3130394070156854)
    call test_one_flat(cmplx([z,z,1/z,(0.,0.),(1.,0.)]),ref,'5.359')
    ref = (-0.06981686057380732,0.15631938505361814)
    call test_one_flat(cmplx([z,z,1/z,(0.,0.),xchen]),ref,'5.360')
    ref = (27.198106756709862,9.568479918707041)
    call test_one_flat(cmplx([z,z,z,(0.,0.),(1.,0.)]),ref,'5.361')
    ref = (3.7546753397146944,17.51971033032644)
    call test_one_flat(cmplx([z,z,z,(0.,0.),xchen]),ref,'5.362')
    ref = (-47.24072354213665,14.164358854931786)
    call test_one_flat(cmplx([z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.363')
    ref = (-38.941938857391975,-7.00307271749986)
    call test_one_flat(cmplx([z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),xchen]),ref,'5.364')
    ref = (0.23647759026111909,0.2788301365598821)
    call test_one_flat(cmplx([z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),(1.,0.)]),ref,'5.365')
    ref = (-0.0035773726994014175,0.18404120959877476)
    call test_one_flat(cmplx([z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),xchen]),ref,'5.366')
    ref = (31.276621337738913,4.828085956021262)
    call test_one_flat(cmplx([z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,(0.,0.),(1.,0.)]),ref,'5.367')
    ref = (9.7870267877781,16.829243073673297)
    call test_one_flat(cmplx([z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,(0.,0.),xchen]),ref,'5.368')
    ref = (-0.1310522872439133,-0.09391326575533451)
    call test_one_flat(cmplx([z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),(1.,0.)]),ref,'5.369')
    ref = (-0.05823894527599742,-0.09391326575533449)
    call test_one_flat(cmplx([z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),(0.,0.),xchen]),ref,'5.370')
    ref = (-0.003301546005469496,-0.0003011948181836658)
    call test_one_flat(cmplx([z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),(1.,0.)]),ref,'5.371')
    ref = (-0.0006363368868334131,-0.00030119481818366575)
    call test_one_flat(cmplx([z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,(0.,0.),xchen]),ref,'5.372')
    ref = (-0.18433869885588738,0.2795831963040149)
    call test_one_flat(cmplx([z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,(0.,0.),(1.,0.)]),ref,'5.373')
    ref = (-0.092749087624319,0.020875736520732213)
    call test_one_flat(cmplx([z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,(0.,0.),xchen]),ref,'5.374')
    ref = (0.7247752567782294,0)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),xchen]),ref,'5.375')
    ref = (0.06852640680945316,0)
    call test_one_flat(cmplx([1/z,(-1.,0.),(0.,0.),(1.,0.)]),ref,'5.376')
    ref = (-0.10674249346303916,0)
    call test_one_flat(cmplx([1/z,(1.,0.),(0.,0.),(1.,0.)]),ref,'5.377')
    ref = (-1.9054448004139888,-0.9960891829613814)
    call test_one_flat(cmplx([z,(-1.,0.),(0.,0.),(1.,0.)]),ref,'5.378')
    ref = (2.6798256522737844,1.0845385544950992)
    call test_one_flat(cmplx([z,(1.,0.),(0.,0.),(1.,0.)]),ref,'5.379')
    ref = (-0.5959537730054196,0)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),xchen]),ref,'5.380')
    ref = (-0.41716387905563224,-0.3309998219690595)
    call test_one_flat(cmplx([z,(1.,0.),xchen]),ref,'5.381')
    ref = (-0.00047054068290311793,0)
    call test_one_flat(cmplx([(-1.,0.),1/z,z]),ref,'5.382')
    ref = (-0.0930632200421551,0)
    call test_one_flat(cmplx([(-1.,0.),z,z]),ref,'5.383')
    ref = (-0.010025111740139094,0)
    call test_one_flat(cmplx([(0.,0.),1/z,z]),ref,'5.384')
    ref = (0.0005378632597719005,0)
    call test_one_flat(cmplx([(1.,0.),1/z,z]),ref,'5.385')
    ref = (0.10816821022923255,0)
    call test_one_flat(cmplx([(1.,0.),z,z]),ref,'5.386')
    ref = (-0.09760523522932159,0)
    call test_one_flat(cmplx([-(1/z),(0.,0.),(1.,0.)]),ref,'5.387')
    ref = (0.000050504625384088926,0)
    call test_one_flat(cmplx([1/z,1/z,z]),ref,'5.388')
    ref = (0.010075616365523026,0)
    call test_one_flat(cmplx([1/z,z,z]),ref,'5.389')
    ref = (-4.198277886858104,0)
    call test_one_flat(cmplx([-z,(0.,0.),(1.,0.)]),ref,'5.390')
    ref = (-1.2405915447167828,-9.403486903947776)
    call test_one_flat(cmplx([((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),(1.,0.)]),ref,'5.391')
    ref = (-0.11766111755714319,-0.015787030641735082)
    call test_one_flat(cmplx([((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,(1.,0.)]),ref,'5.392')
    ref = (-1.7672305517372409,7.072226300816585)
    call test_one_flat(cmplx([((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,(1.,0.)]),ref,'5.393')
    ref = (0.05076817512677344,0)
    call test_one_flat(cmplx([((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),(1.,0.)]),ref,'5.394')
    ref = (0.002684761665372384,0)
    call test_one_flat(cmplx([((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,(1.,0.)]),ref,'5.395')
    ref = (-0.05105566003413771,-0.14577108095714636)
    call test_one_flat(cmplx([((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,(1.,0.)]),ref,'5.396')
    ref = (-0.06536594435445431,0)
    call test_one_flat(cmplx([-(1/z),(0.,0.),xchen]),ref,'5.397')
    ref = (-3.6084361303454555,0)
    call test_one_flat(cmplx([-z,(0.,0.),xchen]),ref,'5.398')
    ref = (-0.41957046525693675,-9.403486903947776)
    call test_one_flat(cmplx([((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),xchen]),ref,'5.399')
    ref = (-0.03837681814432709,-0.015787030641735075)
    call test_one_flat(cmplx([((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,xchen]),ref,'5.400')
    ref = (-3.7244133089473466,2.8770331352725735)
    call test_one_flat(cmplx([((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,xchen]),ref,'5.401')
    ref = (0.03333707969347072,0)
    call test_one_flat(cmplx([((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),xchen]),ref,'5.402')
    ref = (0.0002301687449632136,0)
    call test_one_flat(cmplx([((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,xchen]),ref,'5.403')
    ref = (0.008113292340444082,-0.031814070735191075)
    call test_one_flat(cmplx([((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,xchen]),ref,'5.404')
    ref = (-0.1244370716779412,0.9480866612760035)
    call test_one_flat(cmplx([z - Sqrt((-1.,0.) + z**2),(0.,0.),(1.,0.)]),ref,'5.405')
    ref = (-0.010237890244859554,0.6594273445691843)
    call test_one_flat(cmplx([z - Sqrt((-1.,0.) + z**2),(0.,0.),xchen]),ref,'5.406')
    ref = (-0.02057880947101247,0.038829982715927955)
    call test_one_flat(cmplx([z - Sqrt((-1.,0.) + z**2),1/z,(1.,0.)]),ref,'5.407')
    ref = (-0.00044991508741458263,0.00450090540060089)
    call test_one_flat(cmplx([z - Sqrt((-1.,0.) + z**2),1/z,xchen]),ref,'5.408')
    ref = (2.796092580566623,0.2634976517168147)
    call test_one_flat(cmplx([z - Sqrt((-1.,0.) + z**2),z,(1.,0.)]),ref,'5.409')
    ref = (0.6294250724404404,0.22523173929913898)
    call test_one_flat(cmplx([z - Sqrt((-1.,0.) + z**2),z,xchen]),ref,'5.410')
    ref = (-0.1244370716779412,-0.9480866612760035)
    call test_one_flat(cmplx([z + Sqrt((-1.,0.) + z**2),(0.,0.),(1.,0.)]),ref,'5.411')
    ref = (-0.010237890244859554,-0.6594273445691843)
    call test_one_flat(cmplx([z + Sqrt((-1.,0.) + z**2),(0.,0.),xchen]),ref,'5.412')
    ref = (-0.020578809471012465,-0.03882998271592795)
    call test_one_flat(cmplx([z + Sqrt((-1.,0.) + z**2),1/z,(1.,0.)]),ref,'5.413')
    ref = (-0.00044991508741458263,-0.00450090540060089)
    call test_one_flat(cmplx([z + Sqrt((-1.,0.) + z**2),1/z,xchen]),ref,'5.414')
    ref = (-1.8240243855278646,1.6146626779011979)
    call test_one_flat(cmplx([z + Sqrt((-1.,0.) + z**2),z,(1.,0.)]),ref,'5.415')
    ref = (-0.6169338444594709,-0.10079596204471951)
    call test_one_flat(cmplx([z + Sqrt((-1.,0.) + z**2),z,xchen]),ref,'5.416')
    ref = (-0.03118445081538894,0)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),1/z,(1.,0.)]),ref,'5.417')
    ref = (-0.0037821684351105824,0)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),1/z,xchen]),ref,'5.418')
    ref = (-1.082911384775527,2.736856770167616)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),z,(1.,0.)]),ref,'5.419')
    ref = (-0.4523274450876052,0.33227842147518044)
    call test_one_flat(cmplx([(-1.,0.),(0.,0.),z,xchen]),ref,'5.420')
    ref = (0.0010412695250777162,0)
    call test_one_flat(cmplx([(-1.,0.),1/z,1/z,(1.,0.)]),ref,'5.421')
    ref = (0.00003765744411329043,0)
    call test_one_flat(cmplx([(-1.,0.),1/z,1/z,xchen]),ref,'5.422')
    ref = (-0.010146801983375177,-0.07923625317999604)
    call test_one_flat(cmplx([(-1.,0.),1/z,z,(1.,0.)]),ref,'5.423')
    ref = (0.0032723734484308665,-0.005188213694531391)
    call test_one_flat(cmplx([(-1.,0.),1/z,z,xchen]),ref,'5.424')
    ref = (-0.036642976810948386,-0.018876142099384177)
    call test_one_flat(cmplx([(-1.,0.),z,1/z,(1.,0.)]),ref,'5.425')
    ref = (-0.002279310708677787,-0.0052745759068089145)
    call test_one_flat(cmplx([(-1.,0.),z,1/z,xchen]),ref,'5.426')
    ref = (-2.1882256594051777,1.9492910818751954)
    call test_one_flat(cmplx([(-1.,0.),z,z,(1.,0.)]),ref,'5.427')
    ref = (-0.6351027555707709,-0.18336611522207688)
    call test_one_flat(cmplx([(-1.,0.),z,z,xchen]),ref,'5.428')
    ref = (-0.018129143943673067,0)
    call test_one_flat(cmplx([(0.,0.),(-1.,0.),1/z,(1.,0.)]),ref,'5.429')
    ref = (-0.0020055822300305897,0)
    call test_one_flat(cmplx([(0.,0.),(-1.,0.),1/z,xchen]),ref,'5.430')
    ref = (-0.09830002052571699,1.5877672070636042)
    call test_one_flat(cmplx([(0.,0.),(-1.,0.),z,(1.,0.)]),ref,'5.431')
    ref = (-0.21147526818837808,0.24429075921683596)
    call test_one_flat(cmplx([(0.,0.),(-1.,0.),z,xchen]),ref,'5.432')
    ref = (-0.10128868447922297,0)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),1/z,(1.,0.)]),ref,'5.433')
    ref = (-0.03011351285409006,0)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),1/z,xchen]),ref,'5.434')
    ref = (-5.641811414751341,8.328202076980272)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),z,(1.,0.)]),ref,'5.435')
    ref = (-3.742122594240732,1.8958709942733218)
    call test_one_flat(cmplx([(0.,0.),(0.,0.),z,xchen]),ref,'5.436')
    ref = (0.0665686080432142,0)
    call test_one_flat(cmplx([(0.,0.),(1.,0.),1/z,(1.,0.)]),ref,'5.437')
    ref = (0.002631311529226775,0)
    call test_one_flat(cmplx([(0.,0.),(1.,0.),1/z,xchen]),ref,'5.438')
    ref = (-0.9344639075027588,-4.083174225554871)
    call test_one_flat(cmplx([(0.,0.),(1.,0.),z,(1.,0.)]),ref,'5.439')
    ref = (0.2508599543150823,-0.33854230236432964)
    call test_one_flat(cmplx([(0.,0.),(1.,0.),z,xchen]),ref,'5.440')
    ref = (-0.19757110036140013,0)
    call test_one_flat(cmplx([(0.,0.),-(1/z),(0.,0.),(1.,0.)]),ref,'5.441')
    ref = (-0.0956288174321759,0)
    call test_one_flat(cmplx([(0.,0.),-(1/z),(0.,0.),xchen]),ref,'5.442')
    ref = (0.03739910363704904,0)
    call test_one_flat(cmplx([(0.,0.),1/z,(1.,0.),(1.,0.)]),ref,'5.443')
    ref = (0.0026790272010407956,0)
    call test_one_flat(cmplx([(0.,0.),1/z,1/z,(1.,0.)]),ref,'5.444')
    ref = (0.0002295948848579782,0)
    call test_one_flat(cmplx([(0.,0.),1/z,1/z,xchen]),ref,'5.445')
    ref = (-0.005490576905542178,-0.2181865184146221)
    call test_one_flat(cmplx([(0.,0.),1/z,z,(1.,0.)]),ref,'5.446')
    ref = (0.023132437088404904,-0.028781755771102473)
    call test_one_flat(cmplx([(0.,0.),1/z,z,xchen]),ref,'5.447')
    ref = (-11.84212960751395,0)
    call test_one_flat(cmplx([(0.,0.),-z,(0.,0.),(1.,0.)]),ref,'5.448')
    ref = (-7.032536373149441,0)
    call test_one_flat(cmplx([(0.,0.),-z,(0.,0.),xchen]),ref,'5.449')
    ref = (-1.2148953128016045,-0.7621552558496398)
    call test_one_flat(cmplx([(0.,0.),z,(1.,0.),(1.,0.)]),ref,'5.450')
    ref = (-0.09641072463413439,-0.07270196283659947)
    call test_one_flat(cmplx([(0.,0.),z,1/z,(1.,0.)]),ref,'5.451')
    ref = (-0.0069466912542256965,-0.0346876517291806)
    call test_one_flat(cmplx([(0.,0.),z,1/z,xchen]),ref,'5.452')
    ref = (-7.791170635055706,3.4828725955757616)
    call test_one_flat(cmplx([(0.,0.),z,z,(1.,0.)]),ref,'5.453')
    ref = (-3.2830549733147354,-2.1213489928333154)
    call test_one_flat(cmplx([(0.,0.),z,z,xchen]),ref,'5.454')
    ref = (10.85636255048614,-28.14673183414673)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),(1.,0.)]),ref,'5.455')
    ref = (12.028382071858942,-16.825189335958513)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),xchen]),ref,'5.456')
    ref = (-0.10777867350222846,-0.0472541007893387)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,(1.,0.)]),ref,'5.457')
    ref = (-0.02257860448922367,-0.02824694523562942)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,xchen]),ref,'5.458')
    ref = (-7.503518687171456,5.143676466841473)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,(1.,0.)]),ref,'5.459')
    ref = (-4.021754006530404,-0.8995069768447057)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,xchen]),ref,'5.460')
    ref = (0.10088893426288571,0)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),(1.,0.)]),ref,'5.461')
    ref = (0.04830565509662402,0)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),xchen]),ref,'5.462')
    ref = (0.0013116644488579904,0)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,(1.,0.)]),ref,'5.463')
    ref = (0.00011430984906332359,0)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,xchen]),ref,'5.464')
    ref = (-0.0021368010898526217,-0.10737473600054757)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,(1.,0.)]),ref,'5.465')
    ref = (0.011545754161531042,-0.014310058683189464)
    call test_one_flat(cmplx([(0.,0.),((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,xchen]),ref,'5.466')
    ref = (0.0056969830986427486,0)
    call test_one_flat(cmplx([(1.,0.),(0.,0.),1/z,xchen]),ref,'5.467')
    ref = (0.6616225088303193,-0.528842379082814)
    call test_one_flat(cmplx([(1.,0.),(0.,0.),z,xchen]),ref,'5.468')
    ref = (-0.00005974268041416209,0)
    call test_one_flat(cmplx([(1.,0.),1/z,1/z,xchen]),ref,'5.469')
    ref = (-0.00486802219835899,0.00836643721114921)
    call test_one_flat(cmplx([(1.,0.),1/z,z,xchen]),ref,'5.470')
    ref = (0.004017798920643165,0.00793501715996219)
    call test_one_flat(cmplx([(1.,0.),z,1/z,xchen]),ref,'5.471')
    ref = (1.0049122609705767,0.1940481264952806)
    call test_one_flat(cmplx([(1.,0.),z,z,xchen]),ref,'5.472')
    ref = (0.0012574615795697352,0)
    call test_one_flat(cmplx([1/z,(-1.,0.),1/z,(1.,0.)]),ref,'5.473')
    ref = (0.00004045903798766708,0)
    call test_one_flat(cmplx([1/z,(-1.,0.),1/z,xchen]),ref,'5.474')
    ref = (-0.008778979965114023,-0.09977154553724568)
    call test_one_flat(cmplx([1/z,(-1.,0.),z,(1.,0.)]),ref,'5.475')
    ref = (0.0036193892835016633,-0.00552268633510411)
    call test_one_flat(cmplx([1/z,(-1.,0.),z,xchen]),ref,'5.476')
    ref = (0.005453808983816944,0)
    call test_one_flat(cmplx([1/z,(0.,0.),1/z,(1.,0.)]),ref,'5.477')
    ref = (0.0004615327263656017,0)
    call test_one_flat(cmplx([1/z,(0.,0.),1/z,xchen]),ref,'5.478')
    ref = (0.15840628172365692,-0.4712667745984183)
    call test_one_flat(cmplx([1/z,(0.,0.),z,(1.,0.)]),ref,'5.479')
    ref = (0.0544851110814731,-0.04165726653104456)
    call test_one_flat(cmplx([1/z,(0.,0.),z,xchen]),ref,'5.480')
    ref = (-0.005648740657695776,0)
    call test_one_flat(cmplx([1/z,(1.,0.),1/z,(1.,0.)]),ref,'5.481')
    ref = (-0.00005494773854978987,0)
    call test_one_flat(cmplx([1/z,(1.,0.),1/z,xchen]),ref,'5.482')
    ref = (0.10744261150116663,0.3066358899483396)
    call test_one_flat(cmplx([1/z,(1.,0.),z,(1.,0.)]),ref,'5.483')
    ref = (-0.0043258818620813076,0.007746929443424101)
    call test_one_flat(cmplx([1/z,(1.,0.),z,xchen]),ref,'5.484')
    ref = (-0.002873958874920035,0)
    call test_one_flat(cmplx([1/z,1/z,(1.,0.),(1.,0.)]),ref,'5.485')
    ref = (-0.00019493167387905599,0)
    call test_one_flat(cmplx([1/z,1/z,1/z,(1.,0.)]),ref,'5.486')
    ref = (-4.7098225797919056e-6,0)
    call test_one_flat(cmplx([1/z,1/z,1/z,xchen]),ref,'5.487')
    ref = (0.002324026378729956,0.014269161544495122)
    call test_one_flat(cmplx([1/z,1/z,z,(1.,0.)]),ref,'5.488')
    ref = (-0.0003975911908961069,0.0006542712924388803)
    call test_one_flat(cmplx([1/z,1/z,z,xchen]),ref,'5.489')
    ref = (0.08465495527681435,0.03154765254707111)
    call test_one_flat(cmplx([1/z,z,(1.,0.),(1.,0.)]),ref,'5.490')
    ref = (0.00654956097659765,0.0030093294580803387)
    call test_one_flat(cmplx([1/z,z,1/z,(1.,0.)]),ref,'5.491')
    ref = (0.00030070024282560814,0.0006443909636102089)
    call test_one_flat(cmplx([1/z,z,1/z,xchen]),ref,'5.492')
    ref = (0.3426892452173659,-0.36553891206212474)
    call test_one_flat(cmplx([1/z,z,z,(1.,0.)]),ref,'5.493')
    ref = (0.07954369271711867,0.01934789238237446)
    call test_one_flat(cmplx([1/z,z,z,xchen]),ref,'5.494')
    ref = (0.022930691369871095,0.9435021283922161)
    call test_one_flat(cmplx([1/z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),(1.,0.)]),ref,'5.495')
    ref = (-0.05600346599583895,0.23916865789774522)
    call test_one_flat(cmplx([1/z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),xchen]),ref,'5.496')
    ref = (0.006433883623471583,0.0015839972090796357)
    call test_one_flat(cmplx([1/z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,(1.,0.)]),ref,'5.497')
    ref = (0.0005157291123897476,0.0004015279618445807)
    call test_one_flat(cmplx([1/z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,xchen]),ref,'5.498')
    ref = (0.27947682174312616,-0.41796731017441846)
    call test_one_flat(cmplx([1/z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,(1.,0.)]),ref,'5.499')
    ref = (0.07850038668764595,-0.009545022059506579)
    call test_one_flat(cmplx([1/z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,xchen]),ref,'5.500')
    ref = (-0.004037296661505549,0)
    call test_one_flat(cmplx([1/z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),(1.,0.)]),ref,'5.501')
    ref = (-0.0006239942689126867,0)
    call test_one_flat(cmplx([1/z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),xchen]),ref,'5.502')
    ref = (-0.000095144226684911,0)
    call test_one_flat(cmplx([1/z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,(1.,0.)]),ref,'5.503')
    ref = (-2.342896262894941e-6,0)
    call test_one_flat(cmplx([1/z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,xchen]),ref,'5.504')
    ref = (0.001108427361617685,0.007003354770020925)
    call test_one_flat(cmplx([1/z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,(1.,0.)]),ref,'5.505')
    ref = (-0.0001984058343640843,0.00032520098014480065)
    call test_one_flat(cmplx([1/z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,xchen]),ref,'5.506')
    ref = (-0.0228637477296388,-0.0014782471526235666)
    call test_one_flat(cmplx([z,(-1.,0.),1/z,(1.,0.)]),ref,'5.507')
    ref = (-0.0036276805504087675,-0.0014782471526235592)
    call test_one_flat(cmplx([z,(-1.,0.),1/z,xchen]),ref,'5.508')
    ref = (-0.365113290431382,1.8850822261355527)
    call test_one_flat(cmplx([z,(-1.,0.),z,(1.,0.)]),ref,'5.509')
    ref = (-0.48351581953572964,0.2547740379091432)
    call test_one_flat(cmplx([z,(-1.,0.),z,xchen]),ref,'5.510')
    ref = (-0.12357303113585966,-0.03149481739423776)
    call test_one_flat(cmplx([z,(0.,0.),1/z,(1.,0.)]),ref,'5.511')
    ref = (-0.037138234586813174,-0.031494817394237755)
    call test_one_flat(cmplx([z,(0.,0.),1/z,xchen]),ref,'5.512')
    ref = (-8.321637067025124,7.243663522485173)
    call test_one_flat(cmplx([z,(0.,0.),z,(1.,0.)]),ref,'5.513')
    ref = (-5.884985251510016,-0.6540409487763703)
    call test_one_flat(cmplx([z,(0.,0.),z,xchen]),ref,'5.514')
    ref = (0.07887155606602508,0.0016897472655352582)
    call test_one_flat(cmplx([z,(1.,0.),1/z,(1.,0.)]),ref,'5.515')
    ref = (0.004819722848284727,0.0016897472655352606)
    call test_one_flat(cmplx([z,(1.,0.),1/z,xchen]),ref,'5.516')
    ref = (-0.7532729987792939,-4.827892325441857)
    call test_one_flat(cmplx([z,(1.,0.),z,(1.,0.)]),ref,'5.517')
    ref = (0.588339880271725,-0.4014864752042709)
    call test_one_flat(cmplx([z,(1.,0.),z,xchen]),ref,'5.518')
    ref = (0.04557228322415991,0.001636912112702462)
    call test_one_flat(cmplx([z,1/z,(1.,0.),(1.,0.)]),ref,'5.519')
    ref = (0.003321929971277565,0.00015866496007895835)
    call test_one_flat(cmplx([z,1/z,1/z,(1.,0.)]),ref,'5.520')
    ref = (0.00041842921301972935,0.0001586649600789583)
    call test_one_flat(cmplx([z,1/z,1/z,xchen]),ref,'5.521')
    ref = (0.021776375984700277,-0.2607132460495289)
    call test_one_flat(cmplx([z,1/z,z,(1.,0.)]),ref,'5.522')
    ref = (0.05359282276203083,-0.03213648501096627)
    call test_one_flat(cmplx([z,1/z,z,xchen]),ref,'5.523')
    ref = (-1.2837394307487142,-1.0671013985324442)
    call test_one_flat(cmplx([z,z,(1.,0.),(1.,0.)]),ref,'5.524')
    ref = (-0.0988618464510852,-0.10102878581267744)
    call test_one_flat(cmplx([z,z,1/z,(1.,0.)]),ref,'5.525')
    ref = (0.009856539624442641,-0.05353895391178067)
    call test_one_flat(cmplx([z,z,1/z,xchen]),ref,'5.526')
    ref = (-9.074910065804419,2.415771197043317)
    call test_one_flat(cmplx([z,z,z,(1.,0.)]),ref,'5.527')
    ref = (-3.3650401232637384,-4.41301895058972)
    call test_one_flat(cmplx([z,z,z,xchen]),ref,'5.528')
    ref = (19.312548455911486,-19.41532935415971)
    call test_one_flat(cmplx([z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),(1.,0.)]),ref,'5.529')
    ref = (20.74525494795851,-5.271757251050159)
    call test_one_flat(cmplx([z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,(0.,0.),xchen]),ref,'5.530')
    ref = (-0.11565098028150378,-0.07716485453140784)
    call test_one_flat(cmplx([z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,(1.,0.)]),ref,'5.531')
    ref = (-0.011946654857921018,-0.053419938580959656)
    call test_one_flat(cmplx([z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,1/z,xchen]),ref,'5.532')
    ref = (-9.101113903727644,4.067725330768564)
    call test_one_flat(cmplx([z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,(1.,0.)]),ref,'5.533')
    ref = (-4.6815329276640245,-3.3286657359936465)
    call test_one_flat(cmplx([z,((1.,0.) - Sqrt((1.,0.) - z**2))/z,z,xchen]),ref,'5.534')
    ref = (0.10941228104520333,0.052118190013883944)
    call test_one_flat(cmplx([z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),(1.,0.)]),ref,'5.535')
    ref = (0.044421440290603076,0.05211819001388393)
    call test_one_flat(cmplx([z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,(0.,0.),xchen]),ref,'5.536')
    ref = (0.0016282010086167125,0.00007926603695098904)
    call test_one_flat(cmplx([z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,(1.,0.)]),ref,'5.537')
    ref = (0.00020825943704184634,0.00007926603695098902)
    call test_one_flat(cmplx([z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,1/z,xchen]),ref,'5.538')
    ref = (0.011550756504473268,-0.12828196558527624)
    call test_one_flat(cmplx([z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,(1.,0.)]),ref,'5.539')
    ref = (0.026732005201457052,-0.015926743374189308)
    call test_one_flat(cmplx([z,((1.,0.) + Sqrt((1.,0.) - z**2))/z,z,xchen]),ref,'5.540')
  end subroutine

#ifdef HAVE_GINAC
  subroutine test_one_ginac(z,test_id)
    complex(kind=prec) :: z(:), res, ref, geval
    character(len=*) :: test_id
    if (ginacwhat=="values") then
      print*, '  ', 'testing GPL ', test_id, ' ...'
      ref = geval(z,size(z))
      res = G(z)
      call check(res,ref)
    elseif (ginacwhat=="speed1") then
      ref = geval(z,size(z))
    elseif (ginacwhat=="speed2") then
      res = G(z)
    endif
  end subroutine
  subroutine do_muone_tests(x,y,msg)
    complex(kind=prec) x, y
    real(kind=prec) tstart, tend
    character(len=*) :: msg
    call cpu_time(tstart)
    call test_one_ginac([(-1.,0.),x],'6.1')
    call test_one_ginac([(-1.,0.),(-1.,0.),x],'6.2')
    call test_one_ginac([(0.,0.),(-1.,0.),x],'6.3')
    call test_one_ginac([(-1.,0.),(-1.,0.),(-1.,0.),x],'6.4')
    call test_one_ginac([(-1.,0.),(0.,0.),(-1.,0.),x],'6.5')
    call test_one_ginac([(0.,0.),(-1.,0.),(-1.,0.),x],'6.6')
    call test_one_ginac([(0.,0.),(0.,0.),(-1.,0.),x],'6.7')
    call test_one_ginac([(-1.,0.),(-1.,0.),(-1.,0.),(-1.,0.),x],'6.8')
    call test_one_ginac([(-1.,0.),(-1.,0.),(0.,0.),(-1.,0.),x],'6.9')
    call test_one_ginac([(-1.,0.),(0.,0.),(-1.,0.),(-1.,0.),x],'6.10')
    call test_one_ginac([(-1.,0.),(0.,0.),(0.,0.),(-1.,0.),x],'6.11')
    call test_one_ginac([(0.,0.),(-1.,0.),(-1.,0.),(-1.,0.),x],'6.12')
    call test_one_ginac([(0.,0.),(-1.,0.),(0.,0.),(-1.,0.),x],'6.13')
    call test_one_ginac([(0.,0.),(0.,0.),(-1.,0.),(-1.,0.),x],'6.14')
    call test_one_ginac([(0.,0.),(0.,0.),(0.,0.),(-1.,0.),x],'6.15')
    call test_one_ginac([(0.,0.),y],'6.16')
    call test_one_ginac([(1.,0.),y],'6.17')
    call test_one_ginac([(0.,0.),(0.,0.),y],'6.18')
    call test_one_ginac([(0.,0.),(1.,0.),y],'6.19')
    call test_one_ginac([(1.,0.),(0.,0.),y],'6.20')
    call test_one_ginac([(1.,0.),(1.,0.),y],'6.21')
    call test_one_ginac([(0.,0.),(0.,0.),(0.,0.),y],'6.22')
    call test_one_ginac([(0.,0.),(0.,0.),(1.,0.),y],'6.23')
    call test_one_ginac([(0.,0.),(1.,0.),(0.,0.),y],'6.24')
    call test_one_ginac([(0.,0.),(1.,0.),(1.,0.),y],'6.25')
    call test_one_ginac([(1.,0.),(0.,0.),(0.,0.),y],'6.26')
    call test_one_ginac([(1.,0.),(0.,0.),(1.,0.),y],'6.27')
    call test_one_ginac([(1.,0.),(1.,0.),(0.,0.),y],'6.28')
    call test_one_ginac([(1.,0.),(1.,0.),(1.,0.),y],'6.29')
    call test_one_ginac([(0.,0.),(0.,0.),(0.,0.),(0.,0.),y],'6.30')
    call test_one_ginac([(0.,0.),(0.,0.),(0.,0.),(1.,0.),y],'6.31')
    call test_one_ginac([(0.,0.),(0.,0.),(1.,0.),(0.,0.),y],'6.32')
    call test_one_ginac([(0.,0.),(0.,0.),(1.,0.),(1.,0.),y],'6.33')
    call test_one_ginac([(0.,0.),(1.,0.),(0.,0.),(0.,0.),y],'6.34')
    call test_one_ginac([(0.,0.),(1.,0.),(0.,0.),(1.,0.),y],'6.35')
    call test_one_ginac([(0.,0.),(1.,0.),(1.,0.),(0.,0.),y],'6.36')
    call test_one_ginac([(0.,0.),(1.,0.),(1.,0.),(1.,0.),y],'6.37')
    call test_one_ginac([(1.,0.),(0.,0.),(0.,0.),(0.,0.),y],'6.38')
    call test_one_ginac([(1.,0.),(0.,0.),(0.,0.),(1.,0.),y],'6.39')
    call test_one_ginac([(1.,0.),(0.,0.),(1.,0.),(0.,0.),y],'6.40')
    call test_one_ginac([(1.,0.),(0.,0.),(1.,0.),(1.,0.),y],'6.41')
    call test_one_ginac([(1.,0.),(1.,0.),(0.,0.),(0.,0.),y],'6.42')
    call test_one_ginac([(1.,0.),(1.,0.),(0.,0.),(1.,0.),y],'6.43')
    call test_one_ginac([(1.,0.),(1.,0.),(1.,0.),(0.,0.),y],'6.44')
    call test_one_ginac([(1.,0.),(1.,0.),(1.,0.),(1.,0.),y],'6.45')
    call test_one_ginac([(-1.,0.),y],'6.46')
    call test_one_ginac([(-1.,0.),(0.,0.),(0.,0.),y],'6.47')
    call test_one_ginac([(-1.,0.),(0.,0.),(1.,0.),y],'6.48')
    call test_one_ginac([(-1.,0.),(-1.,0.),y],'6.49')
    call test_one_ginac([(-1.,0.),(0.,0.),y],'6.50')
    call test_one_ginac([(-1.,0.),(1.,0.),y],'6.51')
    call test_one_ginac([(0.,0.),(-1.,0.),y],'6.52')
    call test_one_ginac([(1.,0.),(-1.,0.),y],'6.53')
    call test_one_ginac([(-1.,0.),(-1.,0.),(0.,0.),(0.,0.),y],'6.54')
    call test_one_ginac([(-1.,0.),(-1.,0.),(0.,0.),(1.,0.),y],'6.55')
    call test_one_ginac([(-1.,0.),(0.,0.),(0.,0.),(0.,0.),y],'6.56')
    call test_one_ginac([(-1.,0.),(0.,0.),(0.,0.),(1.,0.),y],'6.57')
    call test_one_ginac([(-1.,0.),(0.,0.),(1.,0.),(0.,0.),y],'6.58')
    call test_one_ginac([(-1.,0.),(0.,0.),(1.,0.),(1.,0.),y],'6.59')
    call test_one_ginac([(-1.,0.),(1.,0.),(0.,0.),(0.,0.),y],'6.60')
    call test_one_ginac([(-1.,0.),(1.,0.),(0.,0.),(1.,0.),y],'6.61')
    call test_one_ginac([(0.,0.),(-1.,0.),(0.,0.),(0.,0.),y],'6.62')
    call test_one_ginac([(0.,0.),(-1.,0.),(0.,0.),(1.,0.),y],'6.63')
    call test_one_ginac([(1.,0.),(-1.,0.),(0.,0.),(0.,0.),y],'6.64')
    call test_one_ginac([(1.,0.),(-1.,0.),(0.,0.),(1.,0.),y],'6.65')
    call test_one_ginac([-(1/y),x],'6.66')
    call test_one_ginac([-y,x],'6.67')
    call test_one_ginac([-(1/y),(-1.,0.),x],'6.68')
    call test_one_ginac([-y,(-1.,0.),x],'6.69')
    call test_one_ginac([-(1/y),(-1.,0.),(-1.,0.),x],'6.70')
    call test_one_ginac([-(1/y),(0.,0.),(-1.,0.),x],'6.71')
    call test_one_ginac([-y,(-1.,0.),(-1.,0.),x],'6.72')
    call test_one_ginac([-y,(0.,0.),(-1.,0.),x],'6.73')
    call test_one_ginac([1 - 1/y - y,-(1/y),x],'6.74')
    call test_one_ginac([-(1/y),-(1/y),x],'6.75')
    call test_one_ginac([-y,-(1/y),x],'6.76')
    call test_one_ginac([1 - 1/y - y,x],'6.77')
    call test_one_ginac([cmplx(0.5,-sqrt(3.)/2.),(0.,0.),y],'6.78')
    call test_one_ginac([cmplx(0.5,-sqrt(3.)/2.),(1.,0.),y],'6.79')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),(0.,0.),y],'6.80')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),(1.,0.),y],'6.81')
    call test_one_ginac([1 - 1/y - y,(-1.,0.),x],'6.82')
    call test_one_ginac([1 - 1/y - y,-y,x],'6.83')
    call test_one_ginac([-(1/y),-y,x],'6.84')
    call test_one_ginac([-y,-y,x],'6.85')
    call test_one_ginac([1 - 1/y - y,-(1/y),(-1.,0.),x],'6.86')
    call test_one_ginac([1 - 1/y - y,-y,(-1.,0.),x],'6.87')
    call test_one_ginac([-(1/y),-(1/y),(-1.,0.),x],'6.88')
    call test_one_ginac([-(1/y),-y,(-1.,0.),x],'6.89')
    call test_one_ginac([-y,-(1/y),(-1.,0.),x],'6.90')
    call test_one_ginac([-y,-y,(-1.,0.),x],'6.91')
    call test_one_ginac([cmplx(0.5,-sqrt(3.)/2.),(0.,0.),(0.,0.),(0.,0.),y],'6.92')
    call test_one_ginac([cmplx(0.5,-sqrt(3.)/2.),(0.,0.),(0.,0.),(1.,0.),y],'6.93')
    call test_one_ginac([cmplx(0.5,-sqrt(3.)/2.),(0.,0.),(1.,0.),(0.,0.),y],'6.94')
    call test_one_ginac([cmplx(0.5,-sqrt(3.)/2.),(0.,0.),(1.,0.),(1.,0.),y],'6.95')
    call test_one_ginac([cmplx(0.5,-sqrt(3.)/2.),(1.,0.),(0.,0.),(0.,0.),y],'6.96')
    call test_one_ginac([cmplx(0.5,-sqrt(3.)/2.),(1.,0.),(0.,0.),(1.,0.),y],'6.97')
    call test_one_ginac([cmplx(0.5,-sqrt(3.)/2.),(1.,0.),(1.,0.),(0.,0.),y],'6.98')
    call test_one_ginac([cmplx(0.5,-sqrt(3.)/2.),(1.,0.),(1.,0.),(1.,0.),y],'6.99')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),(0.,0.),(0.,0.),(0.,0.),y],'6.100')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),(0.,0.),(0.,0.),(1.,0.),y],'6.101')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),(0.,0.),(1.,0.),(0.,0.),y],'6.102')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),(0.,0.),(1.,0.),(1.,0.),y],'6.103')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),(1.,0.),(0.,0.),(0.,0.),y],'6.104')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),(1.,0.),(0.,0.),(1.,0.),y],'6.105')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),(1.,0.),(1.,0.),(0.,0.),y],'6.106')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),(1.,0.),(1.,0.),(1.,0.),y],'6.107')
    call test_one_ginac([1 - 1/y - y,(-1.,0.),(0.,0.),(-1.,0.),x],'6.108')
    call test_one_ginac([1 - 1/y - y,-(1/y),(-1.,0.),(-1.,0.),x],'6.109')
    call test_one_ginac([1 - 1/y - y,-(1/y),(0.,0.),(-1.,0.),x],'6.110')
    call test_one_ginac([1 - 1/y - y,-y,(-1.,0.),(-1.,0.),x],'6.111')
    call test_one_ginac([1 - 1/y - y,-y,(0.,0.),(-1.,0.),x],'6.112')
    call test_one_ginac([-(1/y),(-1.,0.),(-1.,0.),(-1.,0.),x],'6.113')
    call test_one_ginac([-(1/y),(-1.,0.),(0.,0.),(-1.,0.),x],'6.114')
    call test_one_ginac([-(1/y),(0.,0.),(-1.,0.),(-1.,0.),x],'6.115')
    call test_one_ginac([-(1/y),(0.,0.),(0.,0.),(-1.,0.),x],'6.116')
    call test_one_ginac([-(1/y),-(1/y),(-1.,0.),(-1.,0.),x],'6.117')
    call test_one_ginac([-(1/y),-(1/y),(0.,0.),(-1.,0.),x],'6.118')
    call test_one_ginac([-(1/y),-y,(-1.,0.),(-1.,0.),x],'6.119')
    call test_one_ginac([-(1/y),-y,(0.,0.),(-1.,0.),x],'6.120')
    call test_one_ginac([-y,(-1.,0.),(-1.,0.),(-1.,0.),x],'6.121')
    call test_one_ginac([-y,(-1.,0.),(0.,0.),(-1.,0.),x],'6.122')
    call test_one_ginac([-y,(0.,0.),(-1.,0.),(-1.,0.),x],'6.123')
    call test_one_ginac([-y,(0.,0.),(0.,0.),(-1.,0.),x],'6.124')
    call test_one_ginac([-y,-(1/y),(-1.,0.),(-1.,0.),x],'6.125')
    call test_one_ginac([-y,-(1/y),(0.,0.),(-1.,0.),x],'6.126')
    call test_one_ginac([-y,-y,(-1.,0.),(-1.,0.),x],'6.127')
    call test_one_ginac([-y,-y,(0.,0.),(-1.,0.),x],'6.128')
    call test_one_ginac([cmplx(0.5,-sqrt(3.)/2.),y],'6.129')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),y],'6.130')
    call test_one_ginac([(-1.,0.),-y,x],'6.131')
    call test_one_ginac([(-1.,0.),-(1/y),x],'6.132')
    call test_one_ginac([(-1.,0.),-(1/y),(-1.,0.),x],'6.133')
    call test_one_ginac([(-1.,0.),-y,(-1.,0.),x],'6.134')
    call test_one_ginac([(-1.,0.),-(1/y),(-1.,0.),(-1.,0.),x],'6.135')
    call test_one_ginac([(-1.,0.),-(1/y),(0.,0.),(-1.,0.),x],'6.136')
    call test_one_ginac([(-1.,0.),-y,(-1.,0.),(-1.,0.),x],'6.137')
    call test_one_ginac([(-1.,0.),-y,(0.,0.),(-1.,0.),x],'6.138')
    call test_one_ginac([(0.,0.),-(1/y),x],'6.139')
    call test_one_ginac([(0.,0.),-y,x],'6.140')
    call test_one_ginac([(0.,0.),-(1/y),(-1.,0.),x],'6.141')
    call test_one_ginac([(0.,0.),-y,(-1.,0.),x],'6.142')
    call test_one_ginac([(0.,0.),-(1/y),(-1.,0.),(-1.,0.),x],'6.143')
    call test_one_ginac([(0.,0.),-(1/y),(0.,0.),(-1.,0.),x],'6.144')
    call test_one_ginac([(0.,0.),-y,(-1.,0.),(-1.,0.),x],'6.145')
    call test_one_ginac([(0.,0.),-y,(0.,0.),(-1.,0.),x],'6.146')
    call test_one_ginac([(-1.,0.),(-1.,0.),(0.,0.),y],'6.147')
    call test_one_ginac([(0.,0.),(-1.,0.),(0.,0.),y],'6.148')
    call test_one_ginac([(-1.,0.),(-1.,0.),(-1.,0.),(0.,0.),y],'6.149')
    call test_one_ginac([(-1.,0.),(0.,0.),(-1.,0.),(0.,0.),y],'6.150')
    call test_one_ginac([(0.,0.),(-1.,0.),(-1.,0.),(0.,0.),y],'6.151')
    call test_one_ginac([(0.,0.),(0.,0.),(-1.,0.),(0.,0.),y],'6.152')
    call test_one_ginac([(0.,0.),(-1.,0.),(1.,0.),(0.,0.),y],'6.153')
    call test_one_ginac([(0.,0.),(1.,0.),(-1.,0.),(0.,0.),y],'6.154')
    call test_one_ginac([(1.,0.),(0.,0.),(-1.,0.),(0.,0.),y],'6.155')
    call test_one_ginac([(-1.,0.),(1.,0.),(0.,0.),y],'6.156')
    call test_one_ginac([(1.,0.),(-1.,0.),(0.,0.),y],'6.157')
    call test_one_ginac([(-1.,0.),(-1.,0.),(1.,0.),(0.,0.),y],'6.158')
    call test_one_ginac([(-1.,0.),(1.,0.),(-1.,0.),(0.,0.),y],'6.159')
    call test_one_ginac([(-1.,0.),(1.,0.),(1.,0.),(0.,0.),y],'6.160')
    call test_one_ginac([(1.,0.),(-1.,0.),(-1.,0.),(0.,0.),y],'6.161')
    call test_one_ginac([(1.,0.),(-1.,0.),(1.,0.),(0.,0.),y],'6.162')
    call test_one_ginac([(1.,0.),(1.,0.),(-1.,0.),(0.,0.),y],'6.163')
    call test_one_ginac([(0.,0.),(1.,0.),x],'6.164')
    call test_one_ginac([(0.,0.),(1.,0.),(0.,0.),(-1.,0.),x],'6.165')
    call test_one_ginac([(1.,0.),(0.,0.),(-1.,0.),x],'6.166')
    call test_one_ginac([(1.,0.),x],'6.167')
    call test_one_ginac([(-1.,0.),(1.,0.),(0.,0.),(-1.,0.),x],'6.168')
    call test_one_ginac([(1.,0.),(-1.,0.),(0.,0.),(-1.,0.),x],'6.169')
    call test_one_ginac([(1.,0.),(0.,0.),(-1.,0.),(-1.,0.),x],'6.170')
    call test_one_ginac([(1.,0.),(0.,0.),(0.,0.),(-1.,0.),x],'6.171')
    call test_one_ginac([(1.,0.),(1.,0.),(0.,0.),(-1.,0.),x],'6.172')
    call test_one_ginac([(-1.,0.),(1.,0.),x],'6.173')
    call test_one_ginac([(1.,0.),(-1.,0.),x],'6.174')
    call test_one_ginac([(1.,0.),(1.,0.),x],'6.175')
    call test_one_ginac([-(1/y),(1.,0.),x],'6.176')
    call test_one_ginac([-y,(1.,0.),x],'6.177')
    call test_one_ginac([-(1/y),(1.,0.),(0.,0.),(-1.,0.),x],'6.178')
    call test_one_ginac([-y,(1.,0.),(0.,0.),(-1.,0.),x],'6.179')
    call test_one_ginac([(-1 + y - y**2)/y,x],'6.180')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),(0.,0.),y],'6.181')
    call test_one_ginac([-cmplx(-0.5,sqrt(3.)/2.),(0.,0.),y],'6.182')
    call test_one_ginac([(-1 + y - y**2)/y,(-1.,0.),x],'6.183')
    call test_one_ginac([(-1 + y - y**2)/y,-(1/y),x],'6.184')
    call test_one_ginac([(-1 + y - y**2)/y,-y,x],'6.185')
    call test_one_ginac([(-1 + y - y**2)/y,-(1/y),(-1.,0.),x],'6.186')
    call test_one_ginac([(-1 + y - y**2)/y,-y,(-1.,0.),x],'6.187')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),(0.,0.),(0.,0.),(0.,0.),y],'6.188')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),(0.,0.),(1.,0.),(0.,0.),y],'6.189')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),(1.,0.),(0.,0.),(0.,0.),y],'6.190')
    call test_one_ginac([-cmplx(-0.5,sqrt(3.)/2.),(0.,0.),(0.,0.),(0.,0.),y],'6.191')
    call test_one_ginac([-cmplx(-0.5,sqrt(3.)/2.),(0.,0.),(1.,0.),(0.,0.),y],'6.192')
    call test_one_ginac([-cmplx(-0.5,sqrt(3.)/2.),(1.,0.),(0.,0.),(0.,0.),y],'6.193')
    call test_one_ginac([(-1 + y - y**2)/y,(-1.,0.),(0.,0.),(-1.,0.),x],'6.194')
    call test_one_ginac([(-1 + y - y**2)/y,-(1/y),(0.,0.),(-1.,0.),x],'6.195')
    call test_one_ginac([(-1 + y - y**2)/y,-y,(0.,0.),(-1.,0.),x],'6.196')
    call test_one_ginac([cmplx(0.5,sqrt(3.)/2.),y],'6.197')
    call test_one_ginac([-cmplx(-0.5,sqrt(3.)/2.),y],'6.198')
    call cpu_time(tend)
    write(*,900) msg,198./(tend-tstart)

900 format("Evaluating ",A," at ",F8.2,"G/s")
  end subroutine
#endif
  ! subroutine do_shuffle_tests() 
  !   complex(kind=prec) :: v(2) = cmplx((/1,2/))
  !   complex(kind=prec) :: w(2) = cmplx((/3,4/))

  !   call print_matrix(shuffle_product(v,w))
  ! end subroutine do_shuffle_tests

END PROGRAM TEST

! In terminal kann man den exit code bekommen via echo $? 
